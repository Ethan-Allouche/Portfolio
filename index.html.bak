<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Ethan Allouche</title>
    <!-- Favicon -->
    <link rel="icon" href="ethan-allouche.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="ethan-allouche.jpg">

    <!--
      Donn√©es du site (compatibles file:// et GitHub Pages)
      - En local (file://), fetch('./data/content.json') peut √™tre bloqu√© par le navigateur.
      - On charge donc aussi un fichier JS statique qui d√©finit window.__PORTFOLIO_CONTENT__.
      - Apr√®s modification via /admin, remplace data/content.json ET data/content.js.
    -->
    <script src="./data/content.js"></script>
    
    <!-- 1. On charge Tailwind CSS pour le style -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. On charge React et ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. On charge Babel pour traduire le code dans le navigateur -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Style pour l'animation -->
    <style>
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.4s ease-out forwards;
        }
        
        /* --- ANIMATIONS ROBOT --- */
        
        /* Marche (rebond) */
        @keyframes robotWalk {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .robot-walking {
            animation: robotWalk 0.4s infinite ease-in-out;
        }

        /* Repos (Respiration + Vie) - AJUST√â (Plus calme) */
        @keyframes breathe {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.02) translateY(-1px); }
        }
        /* T√™te qui regarde autour (Curiosit√©) - AJUST√â (Plus calme) */
        @keyframes lookAround {
            0%, 100% { transform: rotate(0deg); }
            20% { transform: rotate(-10deg); }
            50% { transform: rotate(0deg); }
            80% { transform: rotate(10deg); }
        }
        /* Bras qui se balancent doucement - AJUST√â (Plus calme) */
        @keyframes armSway {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(10deg); }
        }

        /* Classes pour l'√©tat IDLE (Vivant) */
        .idle-body { animation: breathe 3s infinite ease-in-out; transform-origin: bottom center; }
        .idle-head { animation: lookAround 5s infinite ease-in-out; transform-origin: 50px 45px; } /* Pivot cou */
        .idle-arm-left { animation: armSway 3s infinite ease-in-out; transform-origin: 30px 55px; }
        .idle-arm-right { animation: armSway 3s infinite ease-in-out reverse; transform-origin: 70px 55px; }

        /* Danse (Wiggle) */
        @keyframes robotDance {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-15deg) scale(1.1); }
            75% { transform: rotate(15deg) scale(1.1); }
        }
        .robot-dancing {
            animation: robotDance 0.5s infinite ease-in-out;
            transform-origin: center bottom;
        }

        /* Coucou (Bras) */
        @keyframes waveHand {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-25deg); }
            75% { transform: rotate(5deg); }
        }
        .robot-waving-arm {
            animation: waveHand 0.4s infinite ease-in-out;
            transform-origin: 82px 67px; /* Pivot sur l'√©paule droite */
        }

        /* Panique / Choc (Tremblement) */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .robot-shaking {
            animation: shake 0.5s infinite;
        }

        /* Scan (Laser) */
        @keyframes scanBeam {
            0% { opacity: 0; height: 0; }
            20% { opacity: 0.6; height: 60px; }
            80% { opacity: 0.6; height: 60px; }
            100% { opacity: 0; height: 0; }
        }
        .scan-beam {
            animation: scanBeam 2s ease-in-out infinite;
            transform-origin: top center;
        }

        /* Dormir (Zzz) */
        @keyframes floatZ {
            0% { transform: translateY(0) translateX(0) scale(0.5); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(-30px) translateX(15px) scale(1.2); opacity: 0; }
        }
        .zzz-1 { animation: floatZ 2s infinite ease-out; animation-delay: 0s; }
        .zzz-2 { animation: floatZ 2s infinite ease-out; animation-delay: 0.6s; }
        .zzz-3 { animation: floatZ 2s infinite ease-out; animation-delay: 1.2s; }

        /* Confusion (?) */
        @keyframes floatQuestion {
            0% { transform: translateY(0) scale(0); opacity: 0; }
            20% { transform: translateY(-20px) scale(1.2); opacity: 1; }
            80% { transform: translateY(-25px) scale(1); opacity: 1; }
            100% { transform: translateY(-35px) scale(0.5); opacity: 0; }
        }
        .question-mark {
            animation: floatQuestion 2s infinite ease-out;
        }

        /* Clignement Yeux */
        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }
        .eye-blink {
            animation: blink 4s infinite;
            transform-origin: center;
        }

        /* SAUT (Squash & Stretch) */
        @keyframes jumpMove {
            0% { transform: translateY(0) scaleY(1); }
            20% { transform: translateY(5px) scaleY(0.9); } /* Anticipation (s'√©crase) */
            50% { transform: translateY(-60px) scaleY(1.1); } /* En l'air (s'√©tire) */
            80% { transform: translateY(5px) scaleY(0.9); } /* R√©ception (amorti) */
            100% { transform: translateY(0) scaleY(1); }
        }
        .animate-jump {
            animation: jumpMove 0.5s ease-in-out;
        }

        /* Jonglage */
        @keyframes juggle {
            0% { transform: translateY(0) translateX(0); }
            50% { transform: translateY(-30px) translateX(5px); }
            100% { transform: translateY(0) translateX(10px); }
        }
        .ball-1 { animation: juggle 1s infinite ease-in-out; animation-delay: 0s; }
        .ball-2 { animation: juggle 1s infinite ease-in-out; animation-delay: 0.3s; }
        .ball-3 { animation: juggle 1s infinite ease-in-out; animation-delay: 0.6s; }



        /* --- T√âL√âPORTATION (ESQUIVE) --- */
        @keyframes teleportOut {
            0% { opacity: 1; filter: blur(0px); transform: scale(1) rotate(0deg); }
            100% { opacity: 0; filter: blur(12px); transform: scale(0.25) rotate(-12deg); }
        }
        @keyframes teleportIn {
            0% { opacity: 0; filter: blur(14px); transform: scale(1.8) rotate(12deg); }
            100% { opacity: 1; filter: blur(0px); transform: scale(1) rotate(0deg); }
        }
        .robot-teleport-out { animation: teleportOut 180ms cubic-bezier(.2,.8,.2,1) forwards; }
        .robot-teleport-in { animation: teleportIn 260ms cubic-bezier(.16,1,.3,1) forwards; }

        /* Particules */
        @keyframes sparkFly {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(calc(var(--s, 1) * 0.2)) rotate(var(--r, 0deg)); }
            25% { opacity: 1; }
            100% { opacity: 0; transform: translate(calc(-50% + var(--tx, 0px)), calc(-50% + var(--ty, -40px))) scale(calc(var(--s, 1) * 1.1)) rotate(calc(var(--r, 0deg) + 90deg)); }
        }
        .teleport-spark {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 999px;
            background: radial-gradient(circle, rgba(255,255,255,.95) 0%, rgba(168,85,247,.75) 35%, rgba(59,130,246,0) 70%);
            filter: drop-shadow(0 0 6px rgba(168,85,247,.8));
            animation: sparkFly 320ms ease-out forwards;
            pointer-events: none;
        }

        /* Animation Cercle Progression */
        @keyframes progressLoad {
            from { stroke-dashoffset: 251.2; } /* 2 * PI * 40 (r=40 pour l'exemple) = 251.2 */
        }

        /* Masquer la barre de d√©filement horizontale des onglets sur mobile */
        .no-scrollbar::-webkit-scrollbar {
          display: none;
        }
        .no-scrollbar {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        html, body {
            overflow-x: hidden;
            width: 100%;
        }
    </style>
</head>
<body class="bg-white text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- DEFINITION DES IC√îNES ---
        const IconWrapper = ({ children, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const MapPin = (props) => <IconWrapper {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconWrapper>;
        const Phone = (props) => <IconWrapper {...props}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></IconWrapper>;
        const Mail = (props) => <IconWrapper {...props}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></IconWrapper>;
        const Download = (props) => <IconWrapper {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></IconWrapper>;
        const Cpu = (props) => <IconWrapper {...props}><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></IconWrapper>;
        const Code = (props) => <IconWrapper {...props}><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></IconWrapper>;
        const Briefcase = (props) => <IconWrapper {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></IconWrapper>;
        const GraduationCap = (props) => <IconWrapper {...props}><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"/><path d="M22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></IconWrapper>;
        const Users = (props) => <IconWrapper {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconWrapper>;
        const ChevronRight = (props) => <IconWrapper {...props}><path d="m9 18 6-6-6-6"/></IconWrapper>;
        const User = (props) => <IconWrapper {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconWrapper>;
        const Leaf = (props) => <IconWrapper {...props}><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.5 3 10 0 3-2 6-5 8a7 7 0 0 1-6 0Z"/><path d="M11 20v-9"/></IconWrapper>;
        const Music = (props) => <IconWrapper {...props}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></IconWrapper>;
        const Trophy = (props) => <IconWrapper {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconWrapper>;
        const Home = (props) => <IconWrapper {...props}><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></IconWrapper>;
        const Star = (props) => <IconWrapper {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></IconWrapper>;
        const Heart = (props) => <IconWrapper {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></IconWrapper>;
        const Info = (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="16" y2="12"/><line x1="12" x2="12.01" y1="8" y2="8"/></IconWrapper>;
        const X = (props) => <IconWrapper {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconWrapper>;
        const ZoomIn = (props) => <IconWrapper {...props}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/><line x1="11" x2="11" y1="8" y2="14"/><line x1="8" x2="14" y1="11" y2="11"/></IconWrapper>;
        const Rocket = (props) => <IconWrapper {...props}><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.1 4-1 4-1"/><path d="M12 15v5s3.03-.55 4-2c1.1-1.62 1-4 1-4"/></IconWrapper>;
        const Zap = (props) => <IconWrapper {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconWrapper>;
        const BookOpen = (props) => <IconWrapper {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconWrapper>;
        const LinkIcon = (props) => <IconWrapper {...props}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></IconWrapper>;
        const Linkedin = (props) => <IconWrapper {...props}><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect width="4" height="12" x="2" y="9"/><circle cx="4" cy="4" r="2"/></IconWrapper>;

        // --- NOUVEAU COMPOSANT : CERCLE DE PROGRESSION ---
        const CircularProgress = ({ percentage, colorClass, size = 80, strokeWidth = 8 }) => {
            const radius = (size - strokeWidth) / 2;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (percentage / 100) * circumference;

            return (
                <div className="relative flex items-center justify-center" style={{ width: size, height: size }}>
                    <svg className="w-full h-full transform -rotate-90">
                        {/* Cercle de fond */}
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            stroke="currentColor"
                            strokeWidth={strokeWidth}
                            fill="transparent"
                            className="text-gray-200"
                        />
                        {/* Cercle de progression */}
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            stroke="currentColor"
                            strokeWidth={strokeWidth}
                            fill="transparent"
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                            strokeLinecap="round"
                            className={`${colorClass} transition-all duration-1000 ease-out`}
                        />
                    </svg>
                    <span className={`absolute text-lg font-extrabold ${colorClass}`}>
                        {percentage}%
                    </span>
                </div>
            );
        };



        // --- NOUVEAU COMPOSANT : IMAGE OU VIDEO (AUTO) ---
        // Utilisation :
        //  - Tu passes un src d'image (ex: images/projet-1.jpg)
        //  - Si un fichier mp4 du meme nom existe (ex: images/projet-1.mp4), la video est affichee a la place
        //  - La video est en autoplay + loop + muted + sans controles, et on empeche la pause
        const AutoMedia = ({
            src,
            alt = '',
            className = '',
            interactive = false,
            onOpen = null,
            fallback = null,
            ...rest
        }) => {
            const videoSrc = (typeof src === 'string' && src.match(/\.[a-zA-Z0-9]+$/))
                ? src.replace(/\.[a-zA-Z0-9]+$/, '.mp4')
                : `${src}.mp4`;

            const [videoState, setVideoState] = useState('loading'); // loading | ok | error
            const [imgState, setImgState] = useState('loading');     // loading | ok | error

            useEffect(() => {
                setVideoState('loading');
                setImgState('loading');
            }, [src]);

            const open = useCallback((e) => {
                if (!interactive) return;
                if (e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                const finalSrc = (videoState === 'ok') ? videoSrc : src;
                if (typeof onOpen === 'function') onOpen(finalSrc);
            }, [interactive, onOpen, src, videoSrc, videoState]);

            const preventPause = useCallback((e) => {
                try {
                    const v = e.currentTarget;
                    if (v && v.paused) v.play();
                } catch {}
            }, []);

            // Si video KO et image KO => fallback
            if (videoState === 'error' && imgState === 'error') {
                return fallback;
            }

            const commonProps = {
                className,
                style: interactive ? { cursor: 'zoom-in' } : { pointerEvents: 'none' },
                onClick: open,
                ...rest
            };

            return (
                <>
                    {/* VIDEO (prioritaire) */}
                    {videoState !== 'error' && (
                        <video
                            src={videoSrc}
                            muted
                            playsInline
                            autoPlay
                            loop
                            preload="metadata"
                            poster={src}
                            onLoadedData={() => setVideoState('ok')}
                            onCanPlay={() => setVideoState('ok')}
                            onError={() => setVideoState('error')}
                            onPause={preventPause}
                            onEnded={preventPause}
                            // Emp√™che PiP / downloads (support variable selon navigateurs)
                            disablePictureInPicture
                            controlsList="nodownload noremoteplayback noplaybackrate"
                            {...commonProps}
                        />
                    )}

                    {/* IMAGE (fallback si video absente) */}
                    {videoState === 'error' && (
                        <img
                            src={src}
                            alt={alt}
                            onLoad={() => setImgState('ok')}
                            onError={() => setImgState('error')}
                            {...commonProps}
                        />
                    )}
                </>
            );
        };

        // --- NOUVEAU COMPOSANT : MASCOTTE ROBOT AVEC IA & SKINS ---
        const Mascot = ({ activeTab }) => {
            // Etats
            const [position, setPosition] = useState(5); // Position en %
            const [direction, setDirection] = useState(1); // 1 = droite, -1 = gauche
            const [behavior, setBehavior] = useState('walk'); // walk, scan, sleep, dance, wave, confusion, shock, idle, pageSpecial
            const [isPaused, setIsPaused] = useState(false); // Pause manuelle (clic)
            const [message, setMessage] = useState("");
            const [isJumping, setIsJumping] = useState(false); // Etat pour l'animation de saut

            // T√©l√©portation (esquive)
            const robotRef = useRef(null);
            const [teleportStage, setTeleportStage] = useState(""); // "" | "out" | "in"
            const [sparks, setSparks] = useState([]);

            // Configuration par page (Skin & Action)
            const pageConfig = {
                'accueil': { color: '#3b82f6', action: 'wave', eyeType: 'normal' },
                'competences': { color: '#eab308', action: 'juggling', eyeType: 'star' }, // Jaune or
                'etudes': { color: '#2563eb', action: 'reading', eyeType: 'normal' }, // Bleu fonc√©
                'projets': { color: '#06b6d4', action: 'walk', eyeType: 'normal' }, // Cyan - Action remise √† walk (pas de skin)
                'experience': { color: '#9333ea', action: 'working', eyeType: 'normal' }, // Violet
                'interets': { color: '#db2777', action: 'guitar', eyeType: 'normal' } // Rose
            };

            const currentConfig = pageConfig[activeTab] || pageConfig['accueil'];

            // Calcul de la position verticale
            const isHome = activeTab === 'accueil';
            const verticalPosition = isHome ? 'top-36' : 'top-6';

            // Messages al√©atoires
            const messages = [
                "Bonjour ! üëã",
                "Je cherche un stage ! üöÄ",
                "Vive l'automatisme ! ü§ñ",
                "GEII Power ! ‚ö°",
                "Besoin d'aide ? üõ†Ô∏è",
                "Ethan est motiv√© ! üí™",
                "Scan du syst√®me... OK ‚úÖ",
                "J'aime le code üíª",
                "Bip boup ? üßê",
                "C'est propre ici ‚ú®"
            ];

            // --- CERVEAU DU ROBOT (IA IMPR√âVISIBLE + CONTEXTUELLE) ---
            useEffect(() => {
                if (isPaused) return;

                let timeoutId;

                const think = () => {
                    // Temps al√©atoire avant la prochaine d√©cision (entre 2s et 5s)
                    const timeUntilNextThought = Math.random() * 3000 + 2000;

                    timeoutId = setTimeout(() => {
                        const rand = Math.random();
                        let nextBehavior = 'walk'; 

                        // Probabilit√©s : Plus de chance pour le Random !
                        
                        if (rand < 0.20) {
                            // 20% Contextual Action (si c'est juste walk, √ßa fera rien de sp√©cial)
                            nextBehavior = currentConfig.action; 
                        } else if (rand < 0.50) {
                             // 30% Walk standard
                            nextBehavior = 'walk'; 
                        } else if (rand < 0.65) {
                            // 15% Idle (Observation vivante)
                            nextBehavior = 'idle'; 
                        } else if (rand < 0.75) {
                            nextBehavior = 'scan'; 
                        } else if (rand < 0.82) {
                            nextBehavior = 'dance'; 
                        } else if (rand < 0.89) {
                            nextBehavior = 'wave'; 
                        } else if (rand < 0.96) {
                            nextBehavior = 'confusion'; 
                        } else if (rand < 0.99) {
                            nextBehavior = 'sleep'; 
                        } else {
                            nextBehavior = 'shock'; 
                        }

                        // Logique sp√©cifique si on choisit de marcher
                        if (nextBehavior === 'walk') {
                            if (Math.random() > 0.5) setDirection(prev => prev * -1);
                        }

                        // Dur√©e de l'action
                        setBehavior(nextBehavior);
                        
                        // Si c'est une action sp√©ciale "longue", on peut attendre un peu plus avant de repenser
                        const actionDuration = (nextBehavior === 'sleep' || nextBehavior === 'reading' || nextBehavior === 'guitar') ? 4000 : 0;
                        
                        if(actionDuration > 0) {
                             // On pourrait prolonger le timeout ici si on voulait, mais le rythme actuel est bon
                        }

                        think();
                    }, timeUntilNextThought);
                };

                think(); 

                return () => clearTimeout(timeoutId);
            }, [isPaused, activeTab]); // On relance si on change d'onglet

            // --- D√âCLENCHEUR DE SAUT ---
            useEffect(() => {
                setIsJumping(true);
                const timer = setTimeout(() => setIsJumping(false), 500);
                return () => clearTimeout(timer);
            }, [verticalPosition]);


            // --- MOTEUR PHYSIQUE ---
            useEffect(() => {
                // Ne bouge que si 'walk' (et pas en train de faire une action sp√©ciale statique)
                if (isPaused || behavior !== 'walk') return;

                const interval = setInterval(() => {
                    setPosition(prev => {
                        let newPos = prev + (0.4 * direction); 
                        const rightLimit = isHome ? 55 : 90;
                        const leftLimit = 2;

                        if (newPos > rightLimit) {
                            setDirection(-1);
                            return rightLimit;
                        }
                        if (newPos < leftLimit) {
                            setDirection(1);
                            return leftLimit;
                        }
                        return newPos;
                    });
                }, 50);

                return () => clearInterval(interval);
            }, [direction, isPaused, behavior, isHome]);

            const isTeleporting = teleportStage !== "";

            const makeSparks = (count = 10) => {
                const now = Date.now();
                return Array.from({ length: count }).map((_, i) => {
                    const tx = (Math.random() * 2 - 1) * 42;
                    const ty = -20 - Math.random() * 70;
                    return {
                        id: `${now}-${i}`,
                        x: 50 + (Math.random() * 40 - 20),
                        y: 58 + (Math.random() * 26 - 13),
                        tx,
                        ty,
                        s: (0.6 + Math.random() * 0.9).toFixed(2),
                        r: `${Math.floor(Math.random() * 360)}deg`,
                        d: Math.floor(Math.random() * 120)
                    };
                });
            };

            const teleport = useCallback(() => {
                if (teleportStage) return;

                // Stoppe le mouvement pendant l'esquive
                setIsPaused(true);
                setBehavior('idle');

                // Effet : particules d√©part
                setSparks(makeSparks(12));
                setTeleportStage('out');

                const leftLimit = 2;
                const rightLimit = isHome ? 55 : 90;

                setTimeout(() => {
                    const newPos = leftLimit + Math.random() * (rightLimit - leftLimit);
                    setPosition(newPos);
                    setDirection(Math.random() > 0.5 ? 1 : -1);

                    // Effet : particules arriv√©e
                    setSparks(makeSparks(9));
                    setTeleportStage('in');

                    setTimeout(() => {
                        setTeleportStage('');
                        setSparks([]);
                        setIsPaused(false);
                        setBehavior('walk');
                    }, 260);
                }, 180);
            }, [teleportStage, isHome]);

            // D√©tection "click-through" : m√™me si le robot est derri√®re des blocs
            useEffect(() => {
                const onPointerDown = (e) => {
                    if (!robotRef.current) return;
                    // Si on clique r√©ellement sur le robot (devant), on laisse le onClick g√©rer
                    if (robotRef.current.contains(e.target)) return;

                    const rect = robotRef.current.getBoundingClientRect();
                    const x = e.clientX;
                    const y = e.clientY;

                    if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
                        teleport();
                    }
                };

                document.addEventListener('pointerdown', onPointerDown, true);
                return () => document.removeEventListener('pointerdown', onPointerDown, true);
            }, [teleport]);

            // --- INTERACTION ---
            const handleClick = (e) => {
                if (e) e.stopPropagation();
                teleport();
            };

            // Rendu conditionnel des accessoires
            const showHat = activeTab === 'etudes';
            // showHardHat supprim√© pour 'projets'
            const showBriefcase = activeTab === 'experience' || behavior === 'working';
            const showBook = (activeTab === 'etudes' && behavior === 'reading');
            const showGuitar = (activeTab === 'interets' && behavior === 'guitar');
            const showJuggling = (activeTab === 'competences' && behavior === 'juggling');
            // showGear supprim√© pour 'projets'

            return (
                <div 
                    ref={robotRef}
                    className={`absolute ${verticalPosition} z-0 cursor-pointer transition-all duration-500 ease-in-out group`}
                    style={{ 
                        left: `${position}%`, 
                        transform: `translateX(-50%) scaleX(${direction})`, 
                    }}
                    onClick={handleClick}
                >
                    <div className={isJumping ? "animate-jump" : ""}>
                        {message && (
                            <div 
                                className="absolute -top-20 left-1/2 -translate-x-1/2 bg-white text-slate-800 px-3 py-2 rounded-xl shadow-lg border border-gray-200 text-xs font-bold whitespace-nowrap animate-fadeIn z-50"
                                style={{ transform: `translateX(-50%) scaleX(${direction})` }}
                            >
                                {message}
                                <div className="absolute -bottom-2 left-1/2 -translate-x-1/2 w-3 h-3 bg-white border-b border-r border-gray-200 rotate-45"></div>
                            </div>
                        )}

                        {/* √âL√âMENTS "HAPPENING" */}
                        {behavior === 'sleep' && (
                            <div className="absolute -top-10 right-0" style={{ transform: `scaleX(${direction})` }}>
                                <span className="absolute text-blue-400 font-bold text-lg zzz-1">Z</span>
                                <span className="absolute text-blue-400 font-bold text-sm -mt-2 -ml-3 zzz-2">z</span>
                                <span className="absolute text-blue-400 font-bold text-xs -mt-4 -ml-5 zzz-3">z</span>
                            </div>
                        )}
                        {behavior === 'confusion' && (
                            <div className="absolute -top-12 left-1/2 -translate-x-1/2 question-mark" style={{ transform: `translateX(-50%) scaleX(${direction})` }}>
                                <span className="text-4xl font-bold text-purple-500">?</span>
                            </div>
                        )}
                        {/* JONGLAGE */}
                        {showJuggling && (
                            <div className="absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 pointer-events-none">
                                <div className="absolute w-3 h-3 bg-yellow-400 rounded-full ball-1" style={{left: '10%'}}></div>
                                <div className="absolute w-3 h-3 bg-red-400 rounded-full ball-2" style={{left: '45%'}}></div>
                                <div className="absolute w-3 h-3 bg-blue-400 rounded-full ball-3" style={{left: '80%'}}></div>
                            </div>
                        )}

                        {/* Robot SVG */}
                        <div className={`w-16 h-16 md:w-20 md:h-20 transition-transform relative
                            ${!isTeleporting && behavior === 'walk' && !isJumping ? 'robot-walking' : ''} 
                            ${!isTeleporting && (behavior === 'dance' || showGuitar) ? 'robot-dancing' : ''}
                            ${!isTeleporting && behavior === 'shock' ? 'robot-shaking' : ''}
                            ${!isTeleporting && behavior === 'idle' ? 'idle-body' : ''}
                            ${teleportStage === 'out' ? 'robot-teleport-out' : teleportStage === 'in' ? 'robot-teleport-in' : ''}
                            hover:scale-110`}
                        >
                            {sparks.length > 0 && (
                                <div className="absolute inset-0 pointer-events-none">
                                    {sparks.map(s => (
                                        <span
                                            key={s.id}
                                            className="teleport-spark"
                                            style={{
                                                left: `${s.x}%`,
                                                top: `${s.y}%`,
                                                animationDelay: `${s.d}ms`,
                                                '--tx': `${s.tx}px`,
                                                '--ty': `${s.ty}px`,
                                                '--s': `${s.s}`,
                                                '--r': `${s.r}`
                                            }}
                                        />
                                    ))}
                                </div>
                            )}
                            <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                                
                                {/* Faisceau Scanner */}
                                {behavior === 'scan' && (
                                    <path d="M42 32 L20 100 L65 100 L58 32" fill="url(#scanGradient)" className="scan-beam" style={{opacity: 0.5}} />
                                )}
                                <defs>
                                    <linearGradient id="scanGradient" x1="50" y1="32" x2="50" y2="100" gradientUnits="userSpaceOnUse">
                                        <stop stopColor="red" stopOpacity="0.8"/>
                                        <stop offset="1" stopColor="red" stopOpacity="0"/>
                                    </linearGradient>
                                </defs>

                                {/* Ombre */}
                                <ellipse cx="50" cy="90" rx="20" ry="5" fill="#000" fillOpacity="0.2"/>
                                
                                {/* Roue/Jambes */}
                                <path d="M40 85H60V75H40V85Z" fill="#334155"/>
                                <circle cx="40" cy="85" r="5" fill="#1e293b"/>
                                <circle cx="60" cy="85" r="5" fill="#1e293b"/>

                                {/* Corps */}
                                <rect x="30" y="45" width="40" height="35" rx="5" 
                                      fill={behavior === 'scan' ? "#ef4444" : behavior === 'shock' ? "#f59e0b" : currentConfig.color} 
                                      className="transition-colors duration-500"/>
                                
                                {/* D√©tails Corps */}
                                {activeTab === 'experience' ? (
                                    // Cravate pour Exp√©rience
                                    <path d="M50 45 L55 80 L50 85 L45 80 Z" fill="#4c1d95" />
                                ) : (
                                    // Standard
                                    <>
                                        <rect x="35" y="50" width="30" height="25" rx="2" fill="white" fillOpacity="0.3"/>
                                        <circle cx="50" cy="62" r="5" fill="white" fillOpacity="0.5"/>
                                    </>
                                )}

                                {/* T√™te */}
                                <g 
                                    className={`transition-transform duration-500 ${behavior === 'idle' ? 'idle-head' : ''}`}
                                    transform={behavior === 'confusion' ? "rotate(-10 50 50)" : "" + (behavior === 'sleep' ? "translate(0, 3)" : "")}
                                >
                                    <rect x="32" y="20" width="36" height="25" rx="8" fill="#cbd5e1" />
                                    <rect x="35" y="25" width="30" height="15" rx="4" fill="#0f172a" />
                                    
                                    {/* YEUX */}
                                    {behavior === 'sleep' ? (
                                        <g>
                                            <line x1="40" y1="32" x2="44" y2="32" stroke="#94a3b8" strokeWidth="2"/>
                                            <line x1="56" y1="32" x2="60" y2="32" stroke="#94a3b8" strokeWidth="2"/>
                                        </g>
                                    ) : behavior === 'shock' ? (
                                        <g>
                                            <circle cx="42" cy="32" r="5" fill="#fff" />
                                            <circle cx="42" cy="32" r="2" fill="#000" />
                                            <circle cx="58" cy="32" r="5" fill="#fff" />
                                            <circle cx="58" cy="32" r="2" fill="#000" />
                                        </g>
                                    ) : currentConfig.eyeType === 'star' ? (
                                        // Yeux √âtoiles (Comp√©tences)
                                        <g className="eye-blink">
                                            <polygon points="42,29 43,31 45,31 43.5,32.5 44,34.5 42,33.5 40,34.5 40.5,32.5 39,31 41,31" fill="#fbbf24" />
                                            <polygon points="58,29 59,31 61,31 59.5,32.5 60,34.5 58,33.5 56,34.5 56.5,32.5 55,31 57,31" fill="#fbbf24" />
                                        </g>
                                    ) : (
                                        // Yeux normaux
                                        <g className={behavior === 'idle' || behavior === 'walk' ? "eye-blink" : ""}>
                                            <circle cx="42" cy="32" r={behavior === 'scan' ? 4 : 3} fill={behavior === 'scan' ? "#ef4444" : "#60a5fa"} className="transition-colors"/>
                                            <circle cx="58" cy="32" r={behavior === 'scan' ? 4 : 3} fill={behavior === 'scan' ? "#ef4444" : "#60a5fa"} className="transition-colors"/>
                                        </g>
                                    )}
                                    
                                    {/* Chapeau Dipl√¥m√© (Formation) */}
                                    {showHat && (
                                        <g transform="translate(0, -8)">
                                            <path d="M30 20 L50 10 L70 20 L50 30 Z" fill="#1e1e24" stroke="#000" strokeWidth="1"/>
                                            <rect x="48" y="18" width="4" height="4" fill="#fcd34d"/> 
                                            <path d="M52 20 Q 60 25 62 35" stroke="#fcd34d" strokeWidth="2" fill="none"/>
                                            <circle cx="62" cy="35" r="2" fill="#fcd34d"/>
                                        </g>
                                    )}

                                    {/* Antenne (si pas de chapeau) */}
                                    {!showHat && (
                                        <>
                                            <path d="M50 20V10" stroke="#64748b" strokeWidth="3"/>
                                            <circle cx="50" cy="8" r="4" 
                                                className={`transition-colors ${behavior === 'scan' ? 'fill-red-600 animate-ping' : behavior === 'shock' ? 'fill-yellow-500' : 'fill-red-500 animate-pulse'}`}
                                            />
                                        </>
                                    )}
                                </g>

                                {/* Bras et Accessoires Main */}
                                <g className={behavior === 'dance' ? 'origin-center animate-spin' : ''}>
                                    {/* Bras Gauche (peut tenir objet) */}
                                    <path 
                                        d="M30 55L20 65" 
                                        stroke="#334155" strokeWidth="4" strokeLinecap="round" 
                                        className={behavior === 'idle' ? 'idle-arm-left' : ''}
                                        transform={behavior === 'dance' ? 'rotate(-20 30 55)' : ''}
                                    />
                                    
                                    {/* OBJET MAIN GAUCHE : Guitare */}
                                    {showGuitar && (
                                        <g transform="translate(15, 55) rotate(-45)">
                                            <rect x="0" y="0" width="15" height="25" rx="5" fill="#9d174d" />
                                            <rect x="5" y="-15" width="5" height="20" fill="#713f12" />
                                            <circle cx="7.5" cy="18" r="4" fill="#fce7f3" />
                                        </g>
                                    )}
                                    {/* OBJET MAIN GAUCHE : Livre */}
                                    {showBook && (
                                        <g transform="translate(15, 60)">
                                            <rect x="0" y="0" width="20" height="14" fill="#fff" stroke="#333" />
                                            <path d="M10 0 V14" stroke="#333" strokeWidth="1"/>
                                        </g>
                                    )}
                                    
                                    {/* Bras Droit (Animation Coucou ou Action) */}
                                    <g className={behavior === 'wave' || showGuitar ? 'robot-waving-arm' : ''}>
                                        <path 
                                            d="M70 55L80 65" 
                                            stroke="#334155" strokeWidth="4" strokeLinecap="round"
                                            className={behavior === 'idle' ? 'idle-arm-right' : ''}
                                            transform={behavior === 'dance' ? 'rotate(20 70 55)' : (behavior === 'wave' || showGuitar ? 'rotate(-100 70 55)' : '')}
                                        />
                                        {/* Main droite lev√©e si wave */}
                                        {behavior === 'wave' && (
                                             <path d="M70 55L85 35" stroke="#334155" strokeWidth="4" strokeLinecap="round" />
                                        )}

                                        {/* OBJET MAIN DROITE : Mallette */}
                                        {showBriefcase && (
                                            <g transform="translate(75, 65)">
                                                <rect x="0" y="0" width="16" height="12" rx="1" fill="#581c87" />
                                                <path d="M5 0 V-3 H11 V0" stroke="#581c87" strokeWidth="2" fill="none"/>
                                            </g>
                                        )}
                                    </g>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            );
        };


        // --- APPLICATION PRINCIPALE ---

        const Portfolio = () => {
          const [activeTab, setActiveTab] = useState('accueil');
          const [activeProject, setActiveProject] = useState(null);
          const [activeSkill, setActiveSkill] = useState(null);
          const [activeCoreCompetency, setActiveCoreCompetency] = useState(null); 
          // D√©tail d'un niveau pour une comp√©tence GEII (ex: Concevoir -> Niveau 2)
          // Format : { competencyTitle: string, levelId: 'n1'|'n2'|'n3' }
          const [activeCoreCompetencyLevel, setActiveCoreCompetencyLevel] = useState(null);
          const [activeInterest, setActiveInterest] = useState(null);
          const [activeExperience, setActiveExperience] = useState(null);
          const [activeFormation, setActiveFormation] = useState(null);
          const [isAdmin, setIsAdmin] = useState(false);
          const [fullscreenImage, setFullscreenImage] = useState(null);

          // Scroll en haut
          useEffect(() => {
            try {
              window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (e) {
              window.scrollTo(0, 0);
            }
          }, [activeTab, activeProject, activeSkill, activeCoreCompetency, activeCoreCompetencyLevel, activeInterest, activeExperience, activeFormation]);

          // Admin
          useEffect(() => {
            if (window.location.hash === '#admin-ethan') {
              setIsAdmin(true);
              setActiveTab('admin');
            }
          }, []);

          // --- DONN√âES ---
          const content = window.__PORTFOLIO_CONTENT__ || {};

          const personalInfo = content.personalInfo || {
            name: "Ethan Allouche",
            age: "20 ans",
            address: "B√¢timent B2 r√©sidence l'eau vive, avenue Aristide Briand, 83200 Toulon",
            phone: "06.61.74.78.86",
            email: "Ethan.allouchepro@gmail.com",
            permis: "Permis B",
            objective: "Stage du 23 mars 2026 au 26 juin 2026.",
            formation_actuelle: "BUT (3√®me ann√©e) GEII",
            ecole_actuelle: "Universit√© Toulon - IUT La Garde"
          };

          // --- COMP√âTENCES C≈íURS (MODIFI√â: Comp√©tence GEII + Percentage) ---
          const coreCompetencies = content.coreCompetencies || [
              { 
                title: "Concevoir", 
                percentage: 90,
                circleColor: "text-red-500",
                style: "bg-red-100 border-red-300 text-red-900 hover:shadow-red-500/30 hover:bg-red-200", 
                tagStyle: "bg-red-100 text-red-800 border-red-200",
                desc: "D√©finition de l'architecture mat√©rielle et logicielle, choix des composants, sch√©mas √©lectriques et conception de syst√®mes embarqu√©s."
              },
              { 
                title: "V√©rifier", 
                percentage: 85,
                circleColor: "text-orange-500",
                style: "bg-orange-100 border-orange-300 text-orange-900 hover:shadow-orange-500/30 hover:bg-orange-200", 
                tagStyle: "bg-orange-100 text-orange-800 border-orange-200",
                desc: "Tests unitaires, validation fonctionnelle, simulations et recettes pour assurer la conformit√© aux cahiers des charges."
              },
              { 
                title: "Maintenir", 
                percentage: 80,
                circleColor: "text-amber-500",
                style: "bg-amber-100 border-amber-300 text-amber-900 hover:shadow-amber-500/30 hover:bg-amber-200", 
                tagStyle: "bg-amber-100 text-amber-800 border-amber-200",
                desc: "Diagnostic de pannes, r√©paration, am√©lioration continue et maintenance pr√©ventive/corrective des syst√®mes."
              },
              { 
                title: "Int√©grer", 
                percentage: 95,
                circleColor: "text-emerald-500",
                style: "bg-emerald-100 border-emerald-300 text-emerald-900 hover:shadow-emerald-500/30 hover:bg-emerald-200", 
                tagStyle: "bg-emerald-100 text-emerald-800 border-emerald-200",
                desc: "Mise en r√©seau, communication entre sous-syst√®mes (API, IHM, Capteurs), installation et mise en service sur site."
              } 
          ];

          const skills = content.skills || [
            { 
              name: "C/C++", 
              level: "Notions", 
              val: 40,
              desc: "D√©veloppement bas niveau pour syst√®mes embarqu√©s et microcontr√¥leurs (Arduino, ESP32). Compr√©hension de la gestion m√©moire et des structures de donn√©es."
            },
            { 
              name: "Python", 
              level: "Avanc√©", 
              val: 90,
              desc: "Scripting avanc√©, traitement de donn√©es et automatisation de t√¢ches. Utilisation de biblioth√®ques pour l'interfa√ßage avec des syst√®mes mat√©riels."
            },
            { 
              name: "Langages Automate", 
              level: "Avanc√©", 
              val: 90,
              desc: "Programmation d'automates programmables industriels (API) selon la norme CEI 61131-3. Ma√Ætrise des diagrammes Ladder, Grafcet (SFC) et blocs fonctionnels."
            },
            { 
              name: "HTML / PHP / SQL", 
              level: "Notions", 
              val: 50,
              desc: "Cr√©ation d'interfaces web l√©g√®res pour la supervision de syst√®mes (IHM web) et gestion de bases de donn√©es relationnelles pour l'archivage de mesures."
            },
            { 
              name: "Codesys / Vijeo Designer", 
              level: "Avanc√©", 
              val: 85,
              desc: "Environnement de d√©veloppement standard pour automates (Codesys) et conception d'Interfaces Homme-Machine (IHM) industrielles avec Vijeo Designer."
            },
            { 
              name: "Canvas / Office 365", 
              level: "Professionnel", 
              val: 100,
              desc: "Ma√Ætrise compl√®te de la suite Office pour la documentation technique et de Canvas pour la conception graphique et la pr√©sentation de projets."
            },
            { 
              name: "Automatisation", 
              level: "Avanc√©", 
              val: 85,
              desc: "Analyse fonctionnelle, choix de capteurs/actionneurs et mise en ≈ìuvre de boucles de r√©gulation pour rendre des syst√®mes autonomes."
            },
            { 
              name: "Industrie", 
              level: "Interm√©diaire", 
              val: 70,
              desc: "Connaissance des contraintes du milieu industriel, des protocoles de communication et des normes de s√©curit√©."
            },
            { 
              name: "IoT", 
              level: "Interm√©diaire", 
              val: 75,
              desc: "Internet des Objets : connexion d'objets physiques au r√©seau, protocoles MQTT/HTTP et traitement des donn√©es capteurs."
            },
            { 
              name: "√âcologie", 
              level: "Notions", 
              val: 40,
              desc: "Sensibilisation aux enjeux d'efficacit√© √©nerg√©tique et conception de syst√®mes durables (ex: gestion de l'eau)."
            },
            { 
              name: "√âlectronique", 
              level: "Avanc√©", 
              val: 80,
              desc: "Conception de circuits, soudure, choix de composants et diagnostic de pannes sur cartes √©lectroniques."
            },
            { 
              name: "Signal", 
              level: "Interm√©diaire", 
              val: 65,
              desc: "Traitement du signal, filtrage et conditionnement de signaux analogiques et num√©riques."
            },
            { 
              name: "Arduino", 
              level: "Avanc√©", 
              val: 90,
              desc: "Prototypage rapide de syst√®mes embarqu√©s, interfacing capteurs/actionneurs et programmation de logique de contr√¥le."
            },
            { 
              name: "Robotique", 
              level: "Interm√©diaire", 
              val: 70,
              desc: "Asservissement moteurs, cin√©matique simple et int√©gration de capteurs pour la navigation robotique."
            },
            { 
              name: "Domotique", 
              level: "Interm√©diaire", 
              val: 75,
              desc: "Automatisation de l'habitat, gestion de l'√©clairage et des ouvrants, protocoles type KNX."
            },
            { 
              name: "UniLogic", 
              level: "Interm√©diaire", 
              val: 60,
              desc: "Programmation des automates Unitronics (s√©rie UniStream), int√©grant automate et IHM."
            },
            { 
              name: "Maintenance", 
              level: "Notions", 
              val: 50,
              desc: "Diagnostic de pannes, maintenance pr√©ventive et corrective sur syst√®mes automatis√©s."
            },
          ];

          const formations = content.formations || [
            {
              id: "but-geii",
              date: "En cours",
              title: "BUT (3√®me ann√©e) GEII",
              school: "Universit√© Toulon - IUT La Garde",
              desc: "Sp√©cialit√© AII (Automatisme Informatique Industrielle)",
              isClickable: true,
              image: "geii.jpg"
            },
            {
              id: "habil-br",
              date: "2024",
              title: "Habilitation √âlectrique BR",
              school: "Universit√© de Toulon",
              desc: "Charg√© d'intervention g√©n√©rale en basse tension.",
              isClickable: false
            },
            {
              id: "bac",
              date: "2023",
              title: "Baccalaur√©at G√©n√©ral",
              school: "Lyc√©e Bonaparte, Toulon",
              desc: "Sp√©cialit√©s Maths, Physique-Chimie, SVT. Option Maths Expertes et Sport.",
              isClickable: false
            },
            {
              id: "bafa",
              date: "2023",
              title: "BAFA",
              school: "Brevet d'aptitude aux fonctions d'animateur",
              desc: "",
              isClickable: false
            },
            {
              id: "brevet",
              date: "2020",
              title: "Brevet des Coll√®ges",
              school: "Coll√®ge Les Pins d'Alep, Toulon",
              desc: "Mention Bien",
              isClickable: false
            }
          ];

          const projects = content.projects || [
            {
              id: "station-epuration",
              year: "2025 (En cours)",
              title: "Station d'√©puration automatis√©e",
              desc: "Conception et automatisation d'une maquette de station d'√©puration pouvant nettoyer plus de 200L d'eau.",
              competencies: ["Concevoir", "Int√©grer", "V√©rifier"],
              tags: ["Automatisation", "Industrie", "Langages Automate", "HTML / PHP / SQL", "Codesys / Vijeo Designer", "Canvas / Office 365"]
            },
            {
              id: "systeme-arrosage",
              year: "2025 (120h)",
              title: "Syst√®me d'arrosage automatis√©",
              desc: "Projet de Conception d'un syst√®me automatis√© d'arrosage de plantes.",
              competencies: ["Concevoir", "Int√©grer"],
              tags: ["IoT", "√âcologie", "C/C++", "Langages Automate", "HTML / PHP / SQL", "Codesys / Vijeo Designer", "Canvas / Office 365"]
            },
            {
              id: "emetteur-recepteur-sonore",
              year: "2024 (45h)",
              title: "Syst√®me √âmetteur/R√©cepteur Sonore",
              desc: "Maintenance et conception d'un √©metteur sonore permettant l'allumage d'un robot.",
              competencies: ["Concevoir", "Maintenir"],
              tags: ["√âlectronique", "Signal"]
            },
            {
              id: "robot-detecteur-obstacles",
              year: "2024 (70h)",
              title: "Robot d√©tecteur d'obstacles",
              desc: "Conception et R√©alisation d'un robot roulant t√©l√©command√© sous Arduino.",
              competencies: ["Concevoir", "Int√©grer"],
              tags: ["Arduino", "Robotique", "C/C++"]
            },
            {
              id: "lampe-smartlight",
              year: "2023 (90h)",
              title: "Lampe intelligente SmartLight",
              desc: "Conception et R√©alisation d'une lampe intelligente sous Arduino.",
              competencies: ["Concevoir"],
              tags: ["Arduino", "Domotique", "C/C++", "Canvas / Office 365"]
            },
            {
              id: "maintenance-unilogic",
              year: "2023 (45h)",
              title: "Maintenance Automate UniLogic",
              desc: "Maintenance du syst√®me √©lectrique d'un automate UniLogic sous UniStream.",
              competencies: ["Maintenir", "V√©rifier"],
              tags: ["UniLogic", "Maintenance"]
            }
          ];

          // --- R√âF√âRENTIEL NIVEAUX (COMP√âTENCES GEII) ---
          // 1) Cliquer sur une comp√©tence (Concevoir / V√©rifier / Maintenir / Int√©grer) -> afficher ses niveaux (sans projets)
          // 2) Cliquer sur un niveau -> afficher les projets associ√©s √† ce niveau
          const competencyLevels = content.competencyLevels || {
            "Concevoir": [
              {
                id: "n1",
                label: "Niveau 1",
                mastery: 92,
                desc: "Mener une conception partielle int√©grant une d√©marche projet."
              },
              {
                id: "n2",
                label: "Niveau 2",
                mastery: 85,
                desc: "Concevoir un syst√®me en fiabilisant les solutions propos√©es."
              },
              {
                id: "n3",
                label: "Niveau 3",
                mastery: 78,
                desc: "Concevoir un syst√®me en adoptant une approche s√©lective dans ses choix technologiques."
              }
            ],
            "V√©rifier": [
              {
                id: "n1",
                label: "Niveau 1",
                mastery: 88,
                desc: "Effectuer les tests et mesures n√©cessaires √† une v√©rification d'un syst√®me."
              },
              {
                id: "n2",
                label: "Niveau 2",
                mastery: 80,
                desc: "Mettre en place un protocole de tests pour valider le fonctionnement d'un syst√®me."
              },
              {
                id: "n3",
                label: "Niveau 3",
                mastery: 70,
                desc: "√âlaborer une proc√©dure int√©grant une d√©marche qualit√© pour valider le fonctionnement d'un syst√®me."
              }
            ],
            "Maintenir": [
              {
                id: "n1",
                label: "Niveau 1",
                mastery: 85,
                desc: "Intervenir sur un syst√®me pour effectuer une op√©ration de maintenance."
              },
              {
                id: "n2",
                label: "Niveau 2",
                mastery: 72,
                desc: "Mettre en place une strat√©gie de maintenance pour garantir un fonctionnement optimal."
              }
            ],
            "Int√©grer": [
              {
                id: "n1",
                label: "Niveau 1",
                mastery: 95,
                desc: "R√©aliser / int√©grer un syst√®me en conformit√© avec le dossier de fabrication et une d√©marche qualit√©."
              },
              {
                id: "n2",
                label: "Niveau 2",
                mastery: 88,
                desc: "Interagir avec les diff√©rents acteurs lors de l'installation et de la mise en service d'un syst√®me, dans une d√©marche qualit√©."
              }
            ]
          };

          // Mapping manuel : pour chaque projet, on indique quel niveau il illustre pour chaque comp√©tence.
          // (Cela permet d'afficher les projets par niveau sur la page "Niveau".)
          const projectLevelMap = content.projectLevelMap || {
            "station-epuration":   { "Concevoir": "n3", "V√©rifier": "n3", "Int√©grer": "n2" },
            "systeme-arrosage":    { "Concevoir": "n2", "Int√©grer": "n1" },
            "emetteur-recepteur-sonore": { "Concevoir": "n1", "Maintenir": "n1" },
            "robot-detecteur-obstacles": { "Concevoir": "n2", "Int√©grer": "n1", "V√©rifier": "n1" },
            "lampe-smartlight":    { "Concevoir": "n1" },
            "maintenance-unilogic": { "Maintenir": "n2", "V√©rifier": "n2" }
          };

          const getProjectsForCompetencyLevel = (competencyTitle, levelId) => {
            return projects.filter(p => {
              const m = projectLevelMap[p.id];
              return m && m[competencyTitle] === levelId;
            });
          };

            
          function getProjectIcon(id) {
            switch (id) {
              case "station-epuration":
                return <Cpu size={24} />;
              case "systeme-arrosage":
                return <Leaf size={24} />;
              case "emetteur-recepteur-sonore":
                return <Music size={24} />;
              case "robot-detecteur-obstacles":
                return <Cpu size={24} />;
              case "lampe-smartlight":
                return <Star size={24} />;
              case "maintenance-unilogic":
                return <Code size={24} />;
              default:
                return <Users size={24} />;
            }
          }



const renderInterestIcon = (iconName, size = 24) => {
  switch (iconName) {
    case 'Leaf':
      return <Leaf size={size} />;
    case 'Music':
      return <Music size={size} />;
    case 'Trophy':
      return <Trophy size={size} />;
    case 'Heart':
      return <Heart size={size} />;
    case 'Star':
      return <Star size={size} />;
    default:
      return <Heart size={size} />;
  }
};

          // Experiences
          const experiences = content.experiences || [
            {
              id: "enedis",
              date: "2024 (8 sem.)",
              company: "Enedis, Agence ASGARD",
              title: "Stage Supervision R√©seau",
              desc: "Supervision du r√©seau √©lectrique, gestion des acc√®s, suivi des d√©pannages et validation des pr√©parations de chantiers.",
              details: "Au sein de l'Agence ASGARD (Agence de Supervision, Gestion, Acc√®s, R√©seau et D√©pannage), j'ai d√©couvert le pilotage en temps r√©el du r√©seau de distribution √©lectrique. Ce stage m'a permis de comprendre les enjeux de la continuit√© de service et de la s√©curit√© √©lectrique √† grande √©chelle.",
              tasks: [
                  "Assistance √† la supervision du r√©seau HTA/BT en temps r√©el.",
                  "Analyse des incidents et suivi des d√©pannages avec les √©quipes terrain.",
                  "Validation technique des acc√®s pour les chantiers (pr√©paration des man≈ìuvres).",
                  "Utilisation des outils m√©tiers de cartographie et de gestion (ADMS)."
              ],
              isClickable: true,
              logo: "enedis.jpg"
            },
            {
              id: "univ-toulon",
              date: "2024 - 2025",
              company: "Universit√© de Toulon",
              title: "√âtudiant Ambassadeur GEII",
              desc: "Participation √† la promotion du BUT GEII lors de salons d‚Äôorientation et de la Journ√©e Portes Ouvertes : pr√©sentation de la formation aux lyc√©ens et √† leurs parents, r√©ponse aux questions et accompagnement sur les stands.",
              isClickable: false,
              logo: "univ-toulon.jpg"
            },
            {
              id: "norauto",
              date: "2020 (1 sem.)",
              company: "Norauto Bon-Rencontre",
              title: "Stage de D√©couverte",
              desc: "Observation des m√©caniciens en charge des r√©parations de v√©hicules.",
              isClickable: false,
              logo: "norauto.jpg"
            }
          ];

          const interests = content.interests || [
            { 
              id: "scoutisme",
              title: "Scoutisme", 
              text: "Responsable groupe local (depuis 1 an) et Animateur de camps (11-17 ans).", 
              details: "Engagement fort dans le mouvement scout depuis de nombreuses ann√©es. En tant que responsable de groupe local et animateur, je d√©veloppe des comp√©tences en leadership, gestion de groupe, organisation logistique et p√©dagogie. J'encadre des jeunes de 11 √† 17 ans lors de camps et d'activit√©s tout au long de l'ann√©e, favorisant l'entraide et la vie dans la nature.",
              iconName: 'Leaf', 
              color: "bg-green-100 text-green-700" 
            },
            { 
              id: "musique",
              title: "Musique", 
              text: "Pratique de la guitare classique et du piano depuis 3 ans avec un groupe.", 
              details: "La musique est une passion qui me permet de d√©velopper ma cr√©ativit√© et mon √©coute. Je pratique la guitare classique et le piano. Jouer en groupe depuis 3 ans m'a appris l'importance de la coordination, de l'√©coute mutuelle et du travail collectif pour atteindre une harmonie.",
              iconName: 'Music', 
              color: "bg-purple-100 text-purple-700" 
            },
            { 
              id: "sport",
              title: "Sport", 
              text: "Tennis (8 ans, class√© 30/0), Option Sport au lyc√©e et pratique r√©guli√®re.", 
              details: "Le sport fait partie int√©grante de mon √©quilibre de vie. J'ai pratiqu√© le tennis en comp√©tition pendant 8 ans, atteignant le classement 30/0. J'ai √©galement suivi l'option Sport au lyc√©e. Ces exp√©riences m'ont inculqu√© le go√ªt de l'effort, la pers√©v√©rance et le fair-play.",
              iconName: 'Trophy', 
              color: "bg-orange-100 text-orange-700" 
            }
          ];

          // Textes UI modifiables (optionnel) depuis /data/content.json
          const uiText = content.uiText || {};

          const navItems = [
            { label: "Accueil", id: "accueil", icon: <Home size={18}/> },
            { label: "Comp√©tences", id: "competences", icon: <Star size={18}/> },
            { label: "Formation", id: "etudes", icon: <GraduationCap size={18}/> }, 
            { label: "Projets", id: "projets", icon: <Users size={18}/> },
            { label: "Exp√©rience", id: "experience", icon: <Briefcase size={18}/> },
            { label: "Centres d'int√©r√™t", id: "interets", icon: <Heart size={18}/> }
          ];

          // --- COMPOSANTS DE PAGE ---

          // PageAdminFiles (inchang√©)
          const PageAdminFiles = ({ onExit }) => {
            const [selectedProjectId, setSelectedProjectId] = useState(projects[0] ? projects[0].id : "");
            const [imageIndex, setImageIndex] = useState("1");
            const [imageFile, setImageFile] = useState(null);
            const [pdfFile, setPdfFile] = useState(null);
            const [infoMessage, setInfoMessage] = useState("");

            const currentProject = projects.find(p => p.id === selectedProjectId) || projects[0];

            const downloadRenamedFile = (file, newName) => {
              if (!file || !newName) return;
              const url = URL.createObjectURL(file);
              const link = document.createElement('a');
              link.href = url;
              link.download = newName;
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              URL.revokeObjectURL(url);
            };

            const handleImageSubmit = (e) => {
              e.preventDefault();
              if (!imageFile || !selectedProjectId || !imageIndex) return;
              const newName = `${selectedProjectId}-${imageIndex}.jpg`;
              downloadRenamedFile(imageFile, newName);
              setInfoMessage(`üì∏ Image pr√™te : mets le fichier "${newName}" dans le dossier "images/".`);
            };

            const handlePdfSubmit = (e) => {
              e.preventDefault();
              if (!pdfFile || !selectedProjectId) return;
              const newName = `${selectedProjectId}.pdf`;
              downloadRenamedFile(pdfFile, newName);
              setInfoMessage(`üìÑ PDF pr√™t : mets le fichier "${newName}" dans le dossier "projects/".`);
            };

            if (!currentProject) {
              return (
                <div className="bg-white rounded-2xl shadow-md p-6">
                  <p className="text-sm text-gray-600">Aucun projet d√©tect√© pour le moment.</p>
                </div>
              );
            }

            return (
              <div className="space-y-8 animate-fadeIn">
                <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-md border border-gray-100 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                  <div>
                    <h2 className="text-2xl font-extrabold text-blue-900">Zone admin (secr√®te)</h2>
                    <p className="text-sm text-gray-600 mt-2">
                      Utilise cette page pour g√©n√©rer automatiquement les bons noms de fichiers pour les images et les PDF de chaque projet.
                      Pour y acc√©der directement, ajoute <code className="bg-gray-100 px-1 py-0.5 rounded text-xs">#admin-ethan</code> √† la fin de l'URL.
                    </p>
                  </div>
                  <button
                    onClick={onExit}
                    className="inline-flex items-center justify-center px-4 py-2 rounded-full bg-gray-900 text-white text-sm font-semibold hover:bg-gray-700"
                  >
                    ‚Üê Retour au portfolio
                  </button>
                </div>

                <div className="grid md:grid-cols-2 gap-6">
                  <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4">
                    <h3 className="text-lg font-bold text-blue-900">1. Choisir le projet</h3>
                    <p className="text-sm text-gray-600">
                      Le site attend des fichiers avec ces noms-l√†. On va te g√©n√©rer les bons fichiers automatiquement.
                    </p>
                    <select
                      value={selectedProjectId}
                      onChange={(e) => setSelectedProjectId(e.target.value)}
                      className="w-full mt-2 rounded-xl border-gray-200 text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                      {projects.map((p) => (
                        <option key={p.id} value={p.id}>
                          {p.title} ({p.id})
                        </option>
                      ))}
                    </select>

                    <div className="bg-gray-50 rounded-lg p-3 text-xs text-gray-700 space-y-1 mt-3">
                      <div className="font-semibold mb-1">Fichiers attendus :</div>
                      <div><span className="font-mono">images/{currentProject.id}-1.jpg</span> (image principale)</div>
                      <div><span className="font-mono">images/{currentProject.id}-2.jpg</span></div>
                      <div><span className="font-mono">images/{currentProject.id}-3.jpg</span></div>
                      <div><span className="font-mono">projects/{currentProject.id}.pdf</span></div>
                    </div>
                  </div>

                  <div className="space-y-6">
                    <form
                      onSubmit={handleImageSubmit}
                      className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4"
                    >
                      <h3 className="text-lg font-bold text-blue-900">2. G√©n√©rer une image renomm√©e</h3>
                      <p className="text-xs text-gray-500">
                        Choisis une image sur ton ordinateur (de pr√©f√©rence en .jpg), indique si c'est l'image 1, 2 ou 3, puis clique sur "G√©n√©rer".
                        Le navigateur t√©l√©chargera une copie d√©j√† renomm√©e au bon format.
                      </p>

                      <div className="flex flex-col gap-3">
                        <input
                          type="file"
                          accept="image/*"
                          onChange={(e) => setImageFile(e.target.files && e.target.files[0] ? e.target.files[0] : null)}
                          className="w-full text-sm"
                        />
                        <div className="flex items-center gap-2">
                          <label className="text-sm text-gray-700">Num√©ro d'image :</label>
                          <select
                            value={imageIndex}
                            onChange={(e) => setImageIndex(e.target.value)}
                            className="rounded-xl border-gray-200 text-sm px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500"
                          >
                            <option value="1">1 (principale)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                          </select>
                        </div>
                        <button
                          type="submit"
                          className="inline-flex items-center justify-center px-4 py-2 rounded-full bg-blue-600 text-white text-sm font-semibold hover:bg-blue-500 disabled:opacity-40"
                          disabled={!imageFile}
                        >
                          G√©n√©rer l'image renomm√©e
                        </button>
                      </div>
                    </form>

                    <form
                      onSubmit={handlePdfSubmit}
                      className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4"
                    >
                      <h3 className="text-lg font-bold text-blue-900">3. G√©n√©rer le PDF renomm√©</h3>
                      <p className="text-xs text-gray-500">
                        Choisis le PDF complet de ton projet, puis clique sur "G√©n√©rer". Le fichier t√©l√©charg√© aura d√©j√† le bon nom.
                      </p>

                      <div className="flex flex-col gap-3">
                        <input
                          type="file"
                          accept="application/pdf"
                          onChange={(e) => setPdfFile(e.target.files && e.target.files[0] ? e.target.files[0] : null)}
                          className="w-full text-sm"
                        />
                        <button
                          type="submit"
                          className="inline-flex items-center justify-center px-4 py-2 rounded-full bg-blue-600 text-white text-sm font-semibold hover:bg-blue-500 disabled:opacity-40"
                          disabled={!pdfFile}
                        >
                          G√©n√©rer le PDF renomm√©
                        </button>
                      </div>
                    </form>
                  </div>
                </div>

                {infoMessage && (
                  <div className="bg-emerald-50 border border-emerald-200 text-emerald-800 text-sm rounded-2xl px-4 py-3">
                    {infoMessage}
                  </div>
                )}

                <div className="text-xs text-gray-500">
                  <p className="font-semibold mb-1">√âtapes ensuite :</p>
                  <ul className="list-disc list-inside space-y-1">
                    <li>Ouvre ton projet en local ou ton FTP.</li>
                    <li>Place les images renomm√©es dans le dossier <span className="font-mono">images/</span>.</li>
                    <li>Place les PDF renomm√©s dans le dossier <span className="font-mono">projects/</span>.</li>
                    <li>Tu n'as plus besoin de te souvenir des noms exacts, tout est g√©r√© par cette page üéâ</li>
                  </ul>
                </div>
              </div>
            );
          };


          // 1. PAGE ACCUEIL
          const PageAccueil = () => {
            const featuredProjects = (projects || []).filter(p => !!p.featured);
            const [copied, setCopied] = useState(false);

            const handleCopy = (e) => {
                e.preventDefault();
                navigator.clipboard.writeText(personalInfo.email);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const scrollToContact = () => {
                const element = document.getElementById('contact-section');
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                }
            };

            return (
              <div className="flex flex-col space-y-16 animate-fadeIn pb-12">
                {/* --- HERO SECTION --- */}
                <div className="flex flex-col-reverse md:flex-row items-center justify-between gap-12 pt-8 md:pt-16">
                  <div className="flex-1 text-center md:text-left space-y-6">
                    <div className="inline-block px-4 py-2 bg-blue-100 text-blue-700 font-bold rounded-full text-sm mb-2">
                      üöÄ En recherche de stage (Mars 2026)
                    </div>
                    <h1 className="text-5xl md:text-7xl font-extrabold text-slate-900 tracking-tight leading-tight">
                      Ethan <br/>
                      <span className="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-cyan-500">
                        Allouche
                      </span>
                    </h1>
                    <div className="text-xl text-gray-600 max-w-lg mx-auto md:mx-0 leading-relaxed space-y-4">
                      <p>
                        <strong>Futur Ing√©nieur Automaticien et D√©veloppement Robotique.</strong>
                      </p>
                      <p>
                        Actuellement √©tudiant en <strong>BUT GEII</strong> (G√©nie √âlectrique et Informatique Industrielle), je me sp√©cialise dans la conception de syst√®mes intelligents et autonomes pour l'industrie du futur.
                      </p>
                    </div>
                    
                    <div className="flex flex-wrap gap-4 justify-center md:justify-start pt-4">
                      <button 
                        onClick={() => setActiveTab('projets')}
                        className="px-8 py-4 bg-blue-600 text-white rounded-full font-bold shadow-lg hover:bg-blue-700 hover:shadow-blue-500/30 transition-all transform hover:-translate-y-1"
                      >
                        Voir mes projets
                      </button>
                      
                      {/* BOUTON MODIFI√â ICI */}
                      <button 
                        onClick={scrollToContact}
                        className="px-8 py-4 bg-white text-slate-700 border-2 border-slate-200 rounded-full font-bold hover:border-blue-600 hover:text-blue-600 transition-all"
                      >
                        Me contacter
                      </button>
                    </div>

                    <div className="pt-8 flex items-center justify-center md:justify-start gap-6 text-gray-400">
                        <div title="Python"><Code size={24}/></div>
                        <div title="Automatisme"><Cpu size={24}/></div>
                        <div title="IoT"><Leaf size={24}/></div>
                    </div>
                  </div>

                  {/* RIGHT COLUMN: PHOTO + CV PLACEHOLDER */}
                  <div className="flex flex-col items-center gap-6">
                      
                      {/* Hero Image (smaller and aligned) */}
                      <div className="w-32 h-32 md:w-48 md:h-48 relative group">
                          <div className="absolute inset-0 bg-gradient-to-tr from-blue-600 to-cyan-400 rounded-full rotate-6 opacity-20 group-hover:rotate-12 transition-transform duration-700"></div>
                          <div className="absolute inset-0 bg-white rounded-full shadow-2xl overflow-hidden border-4 border-white/50">
                              <img 
                                src="ethan-allouche.jpg" 
                                alt="Ethan Allouche" 
                                className="w-full h-full object-cover"
                                onError={(e) => { e.target.onerror = null; e.target.src = 'https://via.placeholder.com/400?text=Ethan'; }}
                              />
                          </div>
                      </div>

                      {/* LinkedIn & CV PDF Placeholder */}
                      <div className="flex items-start gap-4">
                          {/* LinkedIn Button */}
                          <a 
                            href="https://www.linkedin.com/in/ethan-allouche/" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            className="bg-[#0077b5] text-white p-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all flex flex-col items-center justify-center gap-1 h-full min-h-[60px]"
                            title="Mon LinkedIn"
                          >
                             <Linkedin size={28} />
                          </a>

                          <div className="w-52 md:w-48 bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden group hover:shadow-xl transition-shadow relative">
                              <div className="bg-gray-50 border-b border-gray-100 p-2 flex justify-between items-center">
                                  <span className="text-xs font-bold text-gray-500 uppercase flex items-center gap-1">
                                    <Briefcase size={12}/> Mon CV
                                  </span>
                                  <a href="projects/CV.pdf" download className="text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded">
                                    <Download size={14}/>
                                  </a>
                              </div>
                              
                              {/* Aspect ratio A4 approx */}
                              {/* CV CLIQUABLE POUR ZOOM */}
                              <div 
                                  className="aspect-[210/297] w-full bg-gray-100 relative flex items-center justify-center cursor-pointer group-hover:opacity-90 transition-opacity"
                                  onClick={() => setFullscreenImage('projects/CV.pdf')}
                              >
                                  <iframe 
                                    src="projects/CV.pdf#toolbar=0&navpanes=0&scrollbar=0" 
                                    className="w-full h-full absolute inset-0 border-0 pointer-events-none"
                                    title="CV Ethan Allouche"
                                  >
                                      <div className="flex flex-col items-center justify-center h-full text-gray-400 p-4 text-center">
                                          <span className="text-xs">Aper√ßu indisponible</span>
                                          <a href="projects/CV.pdf" className="text-blue-600 text-xs font-bold mt-1 underline">T√©l√©charger le PDF</a>
                                      </div>
                                  </iframe>
                                  
                                  {/* Overlay avec ic√¥ne de zoom au survol */}
                                  <div className="absolute inset-0 bg-blue-900/0 group-hover:bg-blue-900/10 transition-colors z-10 flex items-center justify-center">
                                           <ZoomIn className="text-blue-900 opacity-0 group-hover:opacity-100 transform scale-0 group-hover:scale-100 transition-all duration-300 bg-white/80 p-2 rounded-full shadow-lg" size={40} />
                                  </div>
                              </div>
                          </div>
                      </div>

                  </div>
                </div>

                {/* --- FEATURED PROJECTS PREVIEW --- */}
                <div className="space-y-8">
                  <div className="flex justify-between items-end border-b border-gray-100 pb-4">
                      <div>
                        <h2 className="text-3xl font-bold text-slate-800">Projets √† la une</h2>
                        <p className="text-gray-500 mt-1">Quelques r√©alisations r√©centes</p>
                      </div>
                      <button 
                        onClick={() => setActiveTab('projets')} 
                        className="text-blue-600 font-bold flex items-center gap-1 hover:gap-2 transition-all"
                      >
                        Tout voir <ChevronRight size={20} />
                      </button>
                  </div>

                  <div
                    className={
                      featuredProjects.length === 1
                        ? "grid grid-cols-1 gap-8"
                        : featuredProjects.length === 2
                          ? "grid grid-cols-1 md:grid-cols-2 gap-8"
                          : featuredProjects.length === 3
                            ? "grid grid-cols-1 md:grid-cols-2 gap-8"
                            : "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"
                    }
                  >
                      {featuredProjects.length === 0 ? (
                        <div className="col-span-full bg-white rounded-2xl border border-gray-100 p-6 text-gray-600">
                          <div className="font-bold text-slate-800 mb-1">Aucun projet √† la une</div>
                          <div className="text-sm">S√©lectionne des projets √† la une dans la page <span className="font-mono">admin/</span> (case ‚ÄúProjet √† la une‚Äù).</div>
                        </div>
                      ) : (
                        featuredProjects.map((proj, idx) => {
                          const count = featuredProjects.length;
                          const isLastFull = (count === 3 && idx === 2);
                          const isSingle = (count === 1);
                          const mediaH = isSingle
                            ? "h-80 md:h-96"
                            : isLastFull
                              ? "h-72 md:h-80"
                              : "h-64";

                          return (
                            <div
                              key={idx}
                              onClick={() => { setActiveTab('projets'); setActiveProject(proj.id); }}
                              className={
                                "group cursor-pointer bg-white rounded-2xl border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1 " +
                                ((isSingle || isLastFull) ? "md:col-span-2" : "")
                              }
                            >
                              <div className={mediaH + " overflow-hidden relative"}>
                                <AutoMedia 
                                  src={`images/${proj.id}-1.jpg`} 
                                  alt={proj.title}
                                  className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                                  interactive={false}
                                  fallback={null}
                                />
                                <div className="absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 -z-10"></div>
                                <div className="absolute top-4 right-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold text-slate-800 shadow-sm">
                                  {proj.year}
                                </div>
                              </div>
                              <div className="p-6">
                                <h3 className="text-xl font-bold text-slate-800 mb-2 group-hover:text-blue-600 transition-colors">{proj.title}</h3>
                                <p className="text-gray-600 text-sm line-clamp-2">{proj.desc}</p>
                              </div>
                            </div>
                          );
                        })
                      )}
                  </div>
                </div>

                {/* --- QUICK CONTACT --- */}
                {/* ID AJOUT√â ICI : contact-section */}
                <div id="contact-section" className="bg-slate-900 rounded-3xl p-8 md:p-12 text-center text-white relative overflow-hidden">
                    {/* Decorative background pattern */}
                    <div className="absolute top-0 left-0 w-full h-full opacity-10" style={{backgroundImage: 'radial-gradient(circle, #ffffff 1px, transparent 1px)', backgroundSize: '20px 20px'}}></div>
                    
                    <div className="relative z-10 space-y-6">
                      <h2 className="text-3xl md:text-4xl font-bold">Pr√™t √† collaborer ?</h2>
                      <p className="text-blue-200 max-w-2xl mx-auto text-lg">
                          Je suis actuellement √† la recherche d'opportunit√©s de stage pour 2026. Discutons de la mani√®re dont je peux apporter de la valeur √† votre √©quipe.
                      </p>

                      <div className="flex flex-col md:flex-row justify-center items-center gap-4 pt-4">
                          <div className="relative group">
                              <button 
                                onClick={handleCopy}
                                className="px-8 py-3 bg-blue-600 rounded-full font-bold hover:bg-blue-500 transition-colors inline-flex items-center justify-center gap-2 group-active:scale-95"
                              >
                                  <Mail size={20}/> {personalInfo.email}
                              </button>
                              <button 
                                onClick={handleCopy}
                                className="absolute right-[-40px] top-1/2 -translate-y-1/2 bg-white/10 hover:bg-white/20 p-2 rounded-full text-white transition-all"
                                title="Copier l'email"
                              >
                                <LinkIcon size={18}/>
                              </button>
                              
                              {copied && (
                                <div className="absolute -top-10 left-1/2 -translate-x-1/2 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full animate-fadeIn shadow-lg whitespace-nowrap">
                                  Mail copi√© !
                                </div>
                              )}
                          </div>
                      </div>
                    </div>
                </div>
              </div>
            );
          };

          // 2. PAGE CENTRES D'INT√âR√äT
          const PageInterets = ({ onOpenInterest }) => (
             <div className="space-y-8 animate-fadeIn pt-12">
               <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-pink-600 mb-8 relative z-10">
                 <div className="flex items-center gap-4">
                   <div className="bg-pink-600 text-white p-3 rounded-lg">
                      <Heart size={32} />
                   </div>
                   <div>
                     <h2 className="text-3xl font-bold uppercase tracking-widest text-pink-700">Centres d'Int√©r√™t</h2>
                     <p className="text-pink-500 font-medium">Passions, b√©n√©volat et activit√©s sportives</p>
                   </div>
                 </div>
               </div>

               <div className="grid md:grid-cols-3 gap-6 relative z-10">
                  {interests.map((item, idx) => (
                    <div 
                        key={idx} 
                        onClick={() => onOpenInterest(item.id)}
                        className="bg-white rounded-3xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex flex-col w-full overflow-hidden group border border-gray-100 cursor-pointer h-full"
                    >
                        {/* IMAGE HEADER - Avec fallback sur l'ic√¥ne si pas d'image */}
                       <div className={`relative w-full h-48 overflow-hidden flex items-center justify-center ${item.color}`}>
                           <AutoMedia
                              src={`images/${item.id}.jpg`}
                              alt={item.title}
                              className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                              interactive={false}
                              fallback={null}
                           />
                           {/* Ic√¥ne par d√©faut si pas d'image ou en dessous de l'image */}
                           <div className="absolute inset-0 flex items-center justify-center pointer-events-none -z-0">
                                <div className="transform group-hover:scale-110 transition-transform p-4 rounded-full bg-white/30 backdrop-blur-sm">
                                    {item.icon}
                                </div>
                           </div>
                           
                           {/* Overlay au survol */}
                           <div className="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors z-10"></div>
                       </div>

                       <div className="p-6 flex flex-col flex-grow text-center">
                          <h3 className="text-xl font-bold text-gray-800 mb-3 group-hover:text-pink-600 transition-colors">{item.title}</h3>
                          <p className="text-gray-600 leading-relaxed text-sm mb-4 line-clamp-3">
                             {item.text}
                          </p>
                          <div className="mt-auto pt-4 border-t border-gray-100 w-full flex justify-center">
                              <span className="text-pink-600 font-bold text-sm flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all transform translate-y-2 group-hover:translate-y-0">
                                  En savoir plus <ChevronRight size={16}/>
                              </span>
                          </div>
                       </div>
                    </div>
                  ))}
               </div>
             </div>
          );

          // NOUVELLE PAGE : D√âTAIL D'UN CENTRE D'INT√âR√äT
          const PageInteretDetail = ({ interestId, onBack }) => {
            const interest = interests.find(i => i.id === interestId);

            if (!interest) return null;

            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                  {/* Header */}
                  <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-pink-600 mb-8 relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                    <div className="flex items-center gap-4">
                      <div className="bg-pink-600 text-white p-3 rounded-lg">
                        <Heart size={32} />
                      </div>
                      <div>
                        <h2 className="text-3xl font-bold uppercase tracking-widest text-pink-700">{interest.title}</h2>
                      </div>
                    </div>
                    <button
                      onClick={onBack}
                      className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                    >
                      ‚Üê Retour aux int√©r√™ts
                    </button>
                  </div>

                  <div className="grid md:grid-cols-2 gap-8">
                      {/* Image colonne gauche */}
                      <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 h-fit">
                          <div className={`w-full h-64 md:h-80 relative flex items-center justify-center ${interest.color}`}>
                              <AutoMedia
                                 src={`images/${interest.id}.jpg`}
                                 alt={interest.title}
                                 className="w-full h-full object-cover"
                                 interactive={false}
                                 fallback={null}
                              />
                              {/* Fallback Icon */}
                              <div className="absolute inset-0 flex items-center justify-center -z-0">
                                 <div className="transform scale-150 p-6 rounded-full bg-white/30 backdrop-blur-sm">
                                     {renderInterestIcon(interest.iconName)}
                                 </div>
                              </div>
                          </div>
                      </div>

                      {/* Texte colonne droite */}
                      <div className="space-y-6">
                          <div className="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                             <h3 className="text-2xl font-bold text-gray-800 mb-4 border-b border-gray-100 pb-2">√Ä propos</h3>
                             <p className="text-gray-600 leading-relaxed text-lg">
                                  {interest.details || interest.text}
                             </p>
                          </div>

                          <div className="bg-pink-50 p-6 rounded-2xl border border-pink-100">
                             <h4 className="text-pink-800 font-bold mb-2 flex items-center gap-2">
                                 <Star size={20} /> Comp√©tences d√©velopp√©es
                             </h4>
                             <p className="text-pink-700 text-sm italic">
                                 Cette activit√© participe √† mon d√©veloppement personnel et professionnel en renfor√ßant ma curiosit√©, mon esprit d'√©quipe et ma pers√©v√©rance.
                             </p>
                          </div>
                      </div>
                  </div>
              </div>
            );
          };

          // 3. PAGE COMP√âTENCES
          const PageCompetences = ({ onOpenSkill, onOpenCoreCompetency }) => { // AJOUT PROP
            const allSkills = skills;
            
            return (
             <div className="space-y-8 animate-fadeIn pt-12">
               <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-blue-900 mb-8 relative z-10">
                 <div className="flex items-center gap-4">
                   <div className="bg-blue-900 text-white p-3 rounded-lg">
                      <Star size={32} />
                   </div>
                   <div>
                     <h2 className="text-3xl font-bold uppercase tracking-widest text-blue-900">Comp√©tences</h2>
                     <p className="text-blue-600 font-medium">{uiText.competencesSubtitle || "Savoir-faire technique & Logiciels. Cliquez pour voir les projets associ√©s."}</p>
                   </div>
                 </div>
               </div>

               <div className="bg-white p-8 rounded-2xl shadow-xl relative z-10 border border-gray-100">
                  <div className="flex items-center gap-3 mb-8">
                      <Code size={28} className="text-blue-900" />
                      <h3 className="text-xl font-bold text-blue-900 uppercase border-b-2 border-blue-900 pb-1 w-full">
                        Toutes les Comp√©tences
                      </h3>
                   </div>

                   {/* DESIGN GRID 2x2 SANS IC√îNES - AVEC LIEN VERS PAGE D√âTAIL */}
                   <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
                       {coreCompetencies.map((comp, idx) => (
                          <div 
                            key={idx}
                            onClick={() => onOpenCoreCompetency(comp.title)} // CLICK HANDLER
                            className={`
                                ${comp.style} 
                                group cursor-pointer relative overflow-hidden
                                border-2 rounded-2xl p-6 
                                flex items-center justify-center 
                                shadow-sm hover:shadow-lg hover:-translate-y-1 
                                transition-all duration-300 h-24
                            `}
                          >
                             <h3 className="text-xl font-black tracking-wider uppercase text-center">
                                 {comp.title}
                             </h3>
                          </div>
                       ))}
                    </div>
                  
                  <div className="grid md:grid-cols-2 gap-x-12 gap-y-8">
                    {allSkills.map((skill, idx) => (
                      <div 
                        key={idx} 
                        className="group cursor-pointer" 
                        onClick={() => onOpenSkill(skill.name)}
                      >
                        <div className="flex justify-between text-base font-bold text-gray-700 mb-2 group-hover:text-blue-600 transition-colors">
                          <span>{skill.name}</span>
                          <span className="text-blue-600 text-sm bg-blue-50 px-2 py-0.5 rounded">{skill.level}</span>
                        </div>
                        <div className="w-full bg-gray-200 h-3 rounded-full overflow-hidden shadow-inner">
                          <div className="bg-gradient-to-r from-blue-500 to-blue-800 h-full rounded-full transition-all duration-1000 ease-out group-hover:bg-blue-600" style={{ width: `${skill.val}%` }}></div>
                        </div>
                      </div>
                    ))}
                  </div>
               </div>
             </div>
            );
          };

          // PAGE : D√âTAIL D'UNE COMP√âTENCE C≈íUR (GEII) -> affiche les NIVEAUX (sans projets)
          const PageCoreCompetencyDetail = ({ competencyTitle, onBack, onOpenLevel }) => {
            const comp = coreCompetencies.find(c => c.title === competencyTitle);
            const levels = competencyLevels[competencyTitle] || [];

            if (!comp) return null;

            const borderLeftColorClass = (comp.style.split(' ').find(s => s.startsWith('border-')) || 'border-blue-300').replace('border-', 'border-l-');

            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                {/* Header */}
                <div className={`bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 mb-8 relative z-10 flex flex-col gap-6 ${borderLeftColorClass}`}>
                  <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div className="flex items-center gap-4">
                      <div className={`p-3 rounded-lg ${comp.tagStyle} border-none`}>
                        <Star size={32} />
                      </div>
                      <div>
                        <h2 className="text-3xl font-bold uppercase tracking-widest text-gray-900">{comp.title}</h2>
                        <p className="text-gray-600 font-medium">Comp√©tence GEII</p>
                      </div>
                    </div>

                    {/* Ma√Ætrise globale */}
                    <div className="flex flex-col items-center">
                      <CircularProgress percentage={comp.percentage} colorClass={comp.circleColor} />
                      <span className="text-xs font-bold text-gray-500 uppercase mt-1">Ma√Ætrise globale</span>
                    </div>

                    <button
                      onClick={onBack}
                      className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                    >
                      ‚Üê Retour aux comp√©tences
                    </button>
                  </div>

                  <div className={`p-6 rounded-xl border ${comp.style} bg-opacity-30`}>
                    <h4 className="font-bold mb-2 flex items-center gap-2 text-lg"><Info size={20}/> Description :</h4>
                    <p className="text-base leading-relaxed font-medium">{comp.desc}</p>
                  </div>
                </div>

                {/* Niveaux */}
                <div className="space-y-4 relative z-10">
                  <h3 className="text-2xl font-bold text-gray-800">Niveaux de comp√©tence</h3>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    {levels.map((lvl) => {
                      const lvlProjectsCount = getProjectsForCompetencyLevel(competencyTitle, lvl.id).length;

                      return (
                        <button
                          key={lvl.id}
                          type="button"
                          onClick={() => onOpenLevel(lvl.id)}
                          className={`text-left rounded-2xl border-2 p-6 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 bg-white ${comp.style}`}
                        >
                          <div className="flex items-start justify-between gap-4">
                            <div>
                              <div className="text-sm font-extrabold uppercase tracking-wider text-gray-600">{lvl.label}</div>
                              <div className="text-lg font-black tracking-wide text-gray-900 mt-1">{lvl.desc}</div>
                            </div>
                            <div className="shrink-0 text-right">
                              <div className="text-xs font-bold text-gray-600 uppercase">Ma√Ætrise</div>
                              <div className="text-2xl font-black text-gray-900">{lvl.mastery}%</div>
                            </div>
                          </div>

                          <div className="mt-5">
                            <div className="w-full bg-gray-200 h-3 rounded-full overflow-hidden shadow-inner">
                              <div
                                className="bg-gradient-to-r from-blue-500 to-blue-800 h-full rounded-full transition-all duration-700"
                                style={{ width: `${lvl.mastery}%` }}
                              ></div>
                            </div>
                            <div className="flex items-center justify-between mt-3 text-sm">
                              <span className="font-semibold text-gray-800">Projets dans ce niveau</span>
                              <span className="text-xs font-bold px-2 py-1 rounded-full bg-white/60 border border-white/60">{lvlProjectsCount}</span>
                            </div>
                            <div className="mt-3 text-xs font-semibold text-blue-700 flex items-center gap-1">
                              Voir d√©tail du niveau <ChevronRight size={14} />
                            </div>
                          </div>
                        </button>
                      );
                    })}
                  </div>
                </div>
              </div>
            );
          };

          // PAGE : D√âTAIL D'UN NIVEAU (GEII) -> affiche les projets associ√©s √† CE NIVEAU
          const PageCoreCompetencyLevelDetail = ({ competencyTitle, levelId, onBack, onBackToCompetency, onOpenProject }) => {
            const comp = coreCompetencies.find(c => c.title === competencyTitle);
            const lvl = (competencyLevels[competencyTitle] || []).find(l => l.id === levelId);
            const relatedProjects = getProjectsForCompetencyLevel(competencyTitle, levelId);

            if (!comp || !lvl) return null;

            const borderLeftColorClass = (comp.style.split(' ').find(s => s.startsWith('border-')) || 'border-blue-300').replace('border-', 'border-l-');

            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                {/* Header */}
                <div className={`bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 mb-8 relative z-10 flex flex-col gap-6 ${borderLeftColorClass}`}>
                  <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div className="flex items-center gap-4">
                      <div className={`p-3 rounded-lg ${comp.tagStyle} border-none`}>
                        <Star size={32} />
                      </div>
                      <div>
                        <h2 className="text-3xl font-bold uppercase tracking-widest text-gray-900">{comp.title}</h2>
                        <p className="text-gray-600 font-medium">{lvl.label} ‚Äî Comp√©tence GEII</p>
                      </div>
                    </div>

                    <div className="flex flex-col items-center">
                      <CircularProgress percentage={lvl.mastery} colorClass={comp.circleColor} />
                      <span className="text-xs font-bold text-gray-500 uppercase mt-1">Ma√Ætrise niveau</span>
                    </div>

                    <div className="flex flex-wrap gap-2">
                      <button
                        onClick={onBack}
                        className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                      >
                        ‚Üê Retour
                      </button>
                      <button
                        onClick={onBackToCompetency}
                        className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white border border-gray-200 text-gray-800 font-semibold hover:bg-gray-50"
                      >
                        ‚Üê Voir tous les niveaux
                      </button>
                    </div>
                  </div>

                  <div className={`p-6 rounded-xl border ${comp.style} bg-opacity-30`}>
                    <h4 className="font-bold mb-2 flex items-center gap-2 text-lg"><Info size={20}/> Niveau :</h4>
                    <p className="text-base leading-relaxed font-medium">{lvl.desc}</p>
                  </div>
                </div>

                {/* Projets du niveau */}
                <div className="space-y-6 relative z-10">
                  <h3 className="text-2xl font-bold text-gray-800">Projets associ√©s √† ce niveau ({relatedProjects.length})</h3>

                  {relatedProjects.length > 0 ? (
                    <div className="grid md:grid-cols-2 gap-8">
                      {relatedProjects.map((proj, idx) => (
                        <button
                          key={idx}
                          type="button"
                          onClick={() => onOpenProject(proj.id)}
                          className="text-left bg-white rounded-3xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex flex-col w-full overflow-hidden group border border-gray-100"
                        >
                          <div className="relative w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 overflow-hidden">
                            <AutoMedia
                              src={`images/${proj.id}-1.jpg`}
                              alt={proj.title}
                              className="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500"
                              interactive={false}
                              fallback={null}
                            />
                            <div className="absolute inset-0 bg-gradient-to-br from-blue-900/10 to-blue-600/10 z-0"></div>
                            <div className="absolute top-4 right-4 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10">
                              {proj.year}
                            </div>
                            <div className="absolute bottom-4 left-4 bg-white p-2 rounded-xl text-blue-600 shadow-lg z-10">
                              {getProjectIcon(proj.id)}
                            </div>
                          </div>

                          <div className="p-6 flex flex-col flex-grow">
                            <h3 className="font-bold text-xl text-gray-900 mb-2 group-hover:text-blue-600 transition-colors">{proj.title}</h3>
                            <p className="text-gray-600 text-sm leading-relaxed mb-4 flex-grow line-clamp-3">{proj.desc}</p>
                            <div className="flex justify-between items-center pt-4 border-t border-gray-100 mt-auto w-full">
                              <span className="flex items-center gap-1 text-xs font-semibold text-blue-700 opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-[-10px] group-hover:translate-x-0">
                                Voir d√©tail <ChevronRight size={14} />
                              </span>
                            </div>
                          </div>
                        </button>
                      ))}
                    </div>
                  ) : (
                    <div className="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-gray-600 italic">
                      Aucun projet n'est encore associ√© √† ce niveau.
                    </div>
                  )}
                </div>
              </div>
            );
          };

          // NOUVELLE PAGE : D√âTAIL D'UNE COMP√âTENCE
          const PageSkillDetail = ({ skillName, onBack, onOpenProject }) => {
            const skill = skills.find(s => s.name === skillName);
            const relatedProjects = projects.filter(p => p.tags.includes(skillName));

            if (!skill) {
              return (
                <div className="space-y-6 animate-fadeIn pt-12">
                  <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    <p className="text-red-700 font-semibold">Comp√©tence introuvable.</p>
                  </div>
                  <button
                    onClick={onBack}
                    className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                  >
                    ‚Üê Retour aux comp√©tences
                  </button>
                </div>
              );
            }

            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                {/* Header avec Description */}
                <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-blue-900 mb-8 relative z-10 flex flex-col gap-6">
                  <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div className="flex items-center gap-4">
                        <div className="bg-blue-900 text-white p-3 rounded-lg">
                        <Star size={32} />
                        </div>
                        <div>
                        <h2 className="text-3xl font-bold uppercase tracking-widest text-blue-900">{skill.name}</h2>
                        <p className="text-blue-600 font-medium">Niveau : <span className="font-bold">{skill.level}</span></p>
                        </div>
                    </div>
                    <button
                        onClick={onBack}
                        className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                    >
                        ‚Üê Retour aux comp√©tences
                    </button>
                  </div>
                  
                  {/* Zone de description */}
                  <div className="bg-blue-50 p-4 rounded-xl border border-blue-100 text-slate-700 leading-relaxed">
                    <h4 className="font-bold text-blue-900 mb-1 flex items-center gap-2"><Info size={16}/> En savoir plus :</h4>
                    {skill.desc || "Description d√©taill√©e √† venir..."}
                  </div>
                </div>

                {/* Liste des projets associ√©s */}
                <div className="space-y-6 relative z-10">
                  <h3 className="text-2xl font-bold text-gray-800">Projets associ√©s ({relatedProjects.length})</h3>
                  {relatedProjects.length > 0 ? (
                    <div className="grid md:grid-cols-2 gap-8">
                      {relatedProjects.map((proj, idx) => (
                        <button
                          key={idx}
                          type="button"
                          onClick={() => onOpenProject(proj.id)}
                          className="text-left bg-white rounded-3xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex flex-col w-full overflow-hidden group border border-gray-100"
                        >
                          {/* IMAGE HEADER */}
                          <div className="relative w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 overflow-hidden">
                             <AutoMedia
                               src={`images/${proj.id}-1.jpg`}
                               alt={proj.title}
                               className="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500"
                               interactive={false}
                               fallback={null}
                             />
                             <div className="absolute inset-0 bg-gradient-to-br from-blue-900/10 to-blue-600/10 z-0"></div>
                             <div className="absolute top-4 right-4 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10">
                                 {proj.year}
                             </div>
                             <div className="absolute bottom-4 left-4 bg-white p-2 rounded-xl text-blue-600 shadow-lg z-10">
                                 {getProjectIcon(proj.id)}
                             </div>
                          </div>

                          {/* CONTENT BODY */}
                          <div className="p-6 flex flex-col flex-grow">
                             <h3 className="font-bold text-xl text-gray-900 mb-2 group-hover:text-blue-600 transition-colors">{proj.title}</h3>
                             <p className="text-gray-600 text-sm leading-relaxed mb-4 flex-grow line-clamp-3">
                                {proj.desc}
                             </p>
                             <div className="flex justify-between items-center pt-4 border-t border-gray-100 mt-auto w-full">
                                <span className="flex items-center gap-1 text-xs font-semibold text-blue-700 opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-[-10px] group-hover:translate-x-0">
                                   Voir d√©tail <ChevronRight size={14} />
                                </span>
                             </div>
                          </div>
                        </button>
                      ))}
                    </div>
                  ) : (
                    <div className="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-gray-600 italic">
                      Aucun projet n'est encore associ√© √† cette comp√©tence.
                    </div>
                  )}
                </div>
              </div>
            );
          };

          // --- NOUVELLE PAGE D√âTAIL BUT GEII ---
          const PageDetailFormation = ({ onBack }) => {
            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                  {/* Header */}
                  <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-blue-600 mb-8 relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                    <div className="flex items-center gap-4">
                      <div className="bg-blue-600 text-white p-3 rounded-lg">
                        <GraduationCap size={32} />
                      </div>
                      <div>
                        <h2 className="text-3xl font-bold uppercase tracking-widest text-blue-900">BUT GEII</h2>
                        <p className="text-blue-600 font-medium">Bachelor Universitaire de Technologie</p>
                      </div>
                    </div>
                    <button
                      onClick={onBack}
                      className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                    >
                      ‚Üê Retour au parcours
                    </button>
                  </div>

                  <div className="grid md:grid-cols-2 gap-8">
                      {/* Colonne Gauche : Image & Pr√©sentation */}
                      <div className="space-y-6">
                          {/* --- AJOUT IMAGE GEII ICI --- */}
                          <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 h-64 relative group">
  <AutoMedia
    src="images/geii.jpg"
    alt="IUT Toulon GEII"
    className="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
    interactive={false}
    fallback={(
      <div className="w-full h-full bg-gradient-to-br from-blue-100 to-blue-50 flex items-center justify-center flex-col text-blue-300">
        <GraduationCap size={64} />
        <span className="text-sm font-bold mt-2">Media geii.jpg/mp4 manquant</span>
      </div>
    )}
  />
</div>

                          <div className="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                             <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                <Info className="text-blue-600" /> Pr√©sentation de la formation
                             </h3>
                             <p className="text-gray-600 leading-relaxed mb-4">
                                Le <strong>BUT G√©nie √âlectrique et Informatique Industrielle (GEII)</strong> est une formation en 3 ans (niveau Bac+3) qui forme des cadres interm√©diaires capables de concevoir, v√©rifier et maintenir des syst√®mes automatis√©s complexes.
                             </p>
                             <p className="text-gray-600 leading-relaxed">
                                Ma sp√©cialit√©, <strong>Automatisme et Informatique Industrielle (AII)</strong>, met l'accent sur la programmation d'automates, la supervision de processus industriels et l'int√©gration de syst√®mes robotis√©s.
                             </p>
                          </div>

                          <div className="bg-blue-50 p-6 rounded-2xl border border-blue-100">
                             <h4 className="text-blue-900 font-bold mb-3 flex items-center gap-2">
                                 <Trophy size={20} /> Objectifs professionnels
                             </h4>
                             <ul className="space-y-2 text-sm text-blue-800">
                                 <li className="flex items-start gap-2">
                                     <span className="mt-1 w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                     Concevoir la partie commande des syst√®mes automatis√©s.
                                 </li>
                                 <li className="flex items-start gap-2">
                                     <span className="mt-1 w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                     Mettre en place des r√©seaux de communication industriels.
                                 </li>
                                 <li className="flex items-start gap-2">
                                     <span className="mt-1 w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                     Superviser et piloter des installations √† distance.
                                 </li>
                             </ul>
                          </div>
                      </div>

                      {/* Colonne Droite : Modules & Comp√©tences */}
                      <div className="space-y-6">
                           <div className="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                             <h3 className="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                                <BookOpen className="text-blue-600" /> Modules Cl√©s
                             </h3>
                             
                             <div className="space-y-4">
                                 <div className="flex items-start gap-3">
                                     <div className="bg-orange-100 p-2 rounded text-orange-600 shrink-0"><Zap size={20}/></div>
                                     <div>
                                         <h4 className="font-bold text-gray-800">√ânergie & √âlectronique</h4>
                                         <p className="text-sm text-gray-500">Distribution √©lectrique, √©lectronique de puissance, conversion d'√©nergie.</p>
                                     </div>
                                 </div>
                                 <div className="flex items-start gap-3">
                                     <div className="bg-green-100 p-2 rounded text-green-600 shrink-0"><Cpu size={20}/></div>
                                     <div>
                                         <h4 className="font-bold text-gray-800">Automatisme & Robotique</h4>
                                         <p className="text-sm text-gray-500">Programmation API (Ladder, Grafcet), Robots industriels, IHM.</p>
                                     </div>
                                 </div>
                                 <div className="flex items-start gap-3">
                                     <div className="bg-purple-100 p-2 rounded text-purple-600 shrink-0"><Code size={20}/></div>
                                     <div>
                                         <h4 className="font-bold text-gray-800">Informatique Industrielle</h4>
                                         <p className="text-sm text-gray-500">C/C++, Python, R√©seaux locaux, Syst√®mes embarqu√©s.</p>
                                     </div>
                                 </div>
                             </div>
                          </div>
                      </div>
                  </div>
              </div>
            );
          };

          // --- MODIFICATION PAGE ETUDES -> PAGE FORMATION ---
          const PageEtudes = ({ onOpenFormation }) => (
            <div className="space-y-8 animate-fadeIn pt-12">
              <div className="bg-white/90 backdrop-blur p-8 rounded-2xl shadow-lg border-l-8 border-blue-900">
                <div className="flex items-center gap-4 mb-8">
                   <div className="bg-blue-100 p-3 rounded-full text-blue-900">
                     <GraduationCap size={40} />
                   </div>
                   <div>
                     {/* CHANGEMENT DE TITRE ICI : PARCOURS DE FORMATION */}
                     <h2 className="text-3xl font-bold text-blue-900 uppercase">Parcours de Formation</h2>
                     <p className="text-blue-600 font-medium">Formation acad√©mique & Certifications</p>
                   </div>
                </div>
                
                <div className="relative border-l-4 border-blue-100 ml-8 space-y-12">
                  {formations.map((form, idx) => (
                    <div key={idx} className="relative pl-8 group">
                      {/* Timeline dot */}
                      <div className={`absolute -left-[14px] top-1 w-6 h-6 rounded-full border-4 border-white shadow-sm transition-transform 
                        ${form.isClickable ? 'bg-blue-600 group-hover:scale-125 cursor-pointer' : 'bg-blue-500 group-hover:scale-125'}
                      `}></div>
                      
                      {/* Item clickable ou non */}
                      <div 
                        onClick={() => form.isClickable && onOpenFormation()}
                        className={`bg-gray-50 rounded-xl border border-gray-100 transition-all overflow-hidden 
                           ${form.isClickable ? 'hover:bg-blue-50 cursor-pointer hover:shadow-md hover:border-blue-200' : ''}
                        `}
                      >
                        {/* --- IMAGE SECTION SI PR√âSENTE --- */}
                        {form.image && (
                          <div className="h-48 w-full relative">
                             <AutoMedia
                               src={`images/${form.image}`}
                               alt={form.title}
                               className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                               interactive={false}
                               fallback={null}
                             />
                             <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60"></div>
                          </div>
                        )}

                        {/* CONTENT SECTION */}
                        <div className="p-6">
                            <div className="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                              <h3 className={`text-xl font-bold ${form.isClickable ? 'text-blue-800 group-hover:text-blue-600' : 'text-gray-800'}`}>
                                  {form.title} {form.isClickable && <span className="inline-block ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full uppercase tracking-wide">D√©tails</span>}
                              </h3>
                              <span className="inline-block px-3 py-1 bg-blue-900 text-white text-xs font-bold rounded-full">{form.date}</span>
                            </div>
                            <div className="text-blue-700 font-semibold mb-2">{form.school}</div>
                            {form.desc && <p className="text-gray-600 italic">{form.desc}</p>}
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          );

          // PageProjets : Mise √† jour pour les badges cliquables
          const PageProjets = ({ onOpenProject, onOpenSkill, onOpenCoreCompetency }) => ( // AJOUT PROP
            <div className="space-y-8 animate-fadeIn pt-12">
               <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-blue-900 mb-12 relative z-10">
                 <div className="flex items-center gap-4">
                   <div className="bg-blue-900 text-white p-3 rounded-lg">
                      <Users size={32} />
                   </div>
                   <div>
                     <h2 className="text-3xl font-bold uppercase tracking-widest text-blue-900">Projets</h2>
                     <p className="text-blue-600 font-medium">{uiText.projetsSubtitle || "Projets techniques r√©alis√©s en groupe et en autonomie"}</p>
                   </div>
                 </div>
               </div>

               <div className="grid md:grid-cols-2 gap-8 relative z-10">
                 {projects.map((proj, idx) => (
                   <div
                     key={idx}
                     className="bg-white rounded-3xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex flex-col w-full overflow-hidden group border border-gray-100"
                   >
                     {/* IMAGE HEADER - Cliquable pour le projet */}
                     <div 
                        className="relative w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 overflow-hidden cursor-pointer"
                        onClick={() => onOpenProject(proj.id)}
                     >
                        <AutoMedia
                          src={`images/${proj.id}-1.jpg`}
                          alt={proj.title}
                          className="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500"
                          interactive={false}
                          fallback={null}
                        />
                        <div className="absolute inset-0 bg-gradient-to-br from-blue-900/10 to-blue-600/10 z-0"></div>
                        <div className="absolute top-4 right-4 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md z-10">
                            {proj.year}
                        </div>
                        <div className="absolute bottom-4 left-4 bg-white p-2 rounded-xl text-blue-600 shadow-lg z-10">
                            {getProjectIcon(proj.id)}
                        </div>
                     </div>

                     {/* CONTENT BODY */}
                     <div className="p-6 flex flex-col flex-grow">
                        <h3 
                            className="font-bold text-xl text-gray-900 mb-2 group-hover:text-blue-600 transition-colors cursor-pointer"
                            onClick={() => onOpenProject(proj.id)}
                        >
                            {proj.title}
                        </h3>
                        <p className="text-gray-600 text-sm leading-relaxed mb-4 flex-grow line-clamp-3">
                           {proj.desc}
                        </p>

                        <div className="flex justify-between items-end pt-4 border-t border-gray-100 mt-auto w-full">
                           <div className="flex gap-2 flex-wrap flex-grow">
                             {/* AFFICHAGE DES COMP√âTENCES C≈íURS EN PREMIER */}
                             {proj.competencies && proj.competencies.map((compName, i) => {
                                 // Trouver le style correspondant
                                 const coreComp = coreCompetencies.find(c => c.title === compName);
                                 return (
                                     <button 
                                          key={`core-${i}`}
                                          onClick={(e) => { e.stopPropagation(); onOpenCoreCompetency(compName); }}
                                          className={`text-[10px] uppercase font-bold px-2 py-1 rounded transition-colors border ${coreComp ? coreComp.tagStyle : 'bg-gray-100'}`}
                                     >
                                          {compName}
                                     </button>
                                 );
                             })}

                             {proj.tags.map((tag, i) => (
                               <button 
                                  key={i} 
                                  onClick={(e) => { e.stopPropagation(); onOpenSkill(tag); }} // Arr√™t de la propagation pour √©viter d'ouvrir le projet
                                  className="text-[10px] uppercase font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded hover:bg-blue-100 hover:text-blue-800 transition-colors"
                               >
                                  {tag}
                               </button>
                             ))}
                           </div>
                           <button 
                             onClick={() => onOpenProject(proj.id)}
                             className="flex-shrink-0 flex items-center gap-1 text-xs font-semibold text-blue-700 opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-[-10px] group-hover:translate-x-0 ml-2"
                           >
                             <ChevronRight size={18} />
                           </button>
                        </div>
                     </div>
                   </div>
                 ))}
               </div>
            </div>
          );

          // PageExperience
          // Si une exp√©rience est li√©e √† un projet (exp.linkedProjectId), le clic ouvre directement la page projet.
          const PageExperience = ({ onOpenExperience, onOpenProject }) => (
            <div className="space-y-8 animate-fadeIn pt-12">
               <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-purple-600 mb-8 relative z-10">
                 <div className="flex items-center gap-4">
                   <div className="bg-purple-600 text-white p-3 rounded-lg">
                      <Briefcase size={32} />
                   </div>
                   <div>
                     <h2 className="text-3xl font-bold uppercase tracking-widest text-purple-700">Exp√©rience</h2>
                     <p className="text-purple-500 font-medium">Stages et exp√©riences professionnelles</p>
                   </div>
                 </div>
               </div>

               <div className="relative border-l-4 border-purple-100 ml-8 space-y-12">
                 {experiences.map((exp, idx) => (
                   <div key={idx} className="relative pl-8 group">
                     <div className={`absolute -left-[14px] top-1 w-6 h-6 rounded-full border-4 border-white shadow-sm transition-transform 
                       ${exp.isClickable ? 'bg-purple-600 group-hover:scale-125 cursor-pointer' : 'bg-purple-400 group-hover:scale-125'}
                     `}></div>
                     
                     <div 
                         onClick={() => {
                           if (!exp.isClickable) return;
                           if (exp.linkedProjectId && typeof onOpenProject === 'function') {
                             onOpenProject(exp.linkedProjectId);
                             return;
                           }
                           onOpenExperience(exp);
                         }}
                         className={`bg-white p-6 rounded-xl border border-gray-100 shadow-sm transition-all 
                           ${exp.isClickable ? 'hover:shadow-md hover:border-purple-200 cursor-pointer' : ''}
                         `}
                     >
                         <div className="flex flex-col sm:flex-row gap-4">
                             {/* Logo Section */}
                             <div className="shrink-0">
                                <div className="w-16 h-16 rounded-full border border-gray-100 overflow-hidden bg-white p-1 shadow-sm">
                                   <AutoMedia
                                      src={`images/${exp.logo}`}
                                      alt={exp.company}
                                      className="w-full h-full object-cover rounded-full"
                                      interactive={false}
                                      fallback={(
                                        <div className="w-full h-full bg-purple-100 flex items-center justify-center rounded-full text-purple-500">
                                          <Briefcase size={24} />
                                        </div>
                                      )}
                                    />
                                </div>
                             </div>

                             {/* Content Section */}
                             <div className="flex-grow">
                                 <div className="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                                     <h3 className={`text-xl font-bold ${exp.isClickable ? 'text-purple-800 group-hover:text-purple-600' : 'text-gray-800'}`}>
                                         {exp.title} {exp.isClickable && <span className="inline-block ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full uppercase tracking-wide">{exp.linkedProjectId ? 'Projet' : 'D√©tails'}</span>}
                                     </h3>
                                     <span className="inline-block px-3 py-1 bg-purple-100 text-purple-800 text-xs font-bold rounded-full w-fit mt-1 md:mt-0">{exp.date}</span>
                                 </div>
                                 <div className="text-purple-600 font-semibold mb-2">{exp.company}</div>
                                 <p className="text-gray-600 text-sm leading-relaxed">{exp.desc}</p>
                             </div>
                         </div>
                     </div>
                   </div>
                 ))}
               </div>
            </div>
          );

          // PageExperienceDetail
          const PageExperienceDetail = ({ experience, onBack }) => {
            if (!experience) return null;

            return (
               <div className="space-y-8 animate-fadeIn pt-12">
                  <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-purple-600 mb-8 relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                    <div className="flex items-center gap-4">
                       <div className="bg-purple-600 text-white p-3 rounded-lg">
                          <Briefcase size={32} />
                       </div>
                       <div>
                         <h2 className="text-3xl font-bold uppercase tracking-widest text-purple-700">{experience.company}</h2>
                         <p className="text-purple-500 font-medium">{experience.title} - {experience.date}</p>
                       </div>
                    </div>
                    <button
                      onClick={onBack}
                      className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700"
                    >
                      ‚Üê Retour aux exp√©riences
                    </button>
                  </div>

                  <div className="grid md:grid-cols-3 gap-8">
                     <div className="md:col-span-2 space-y-6">
                        <div className="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                             <h3 className="text-xl font-bold text-gray-800 mb-4 border-b border-gray-100 pb-2">Contexte</h3>
                             <p className="text-gray-600 leading-relaxed text-lg">
                                {experience.details}
                             </p>
                        </div>
                        
                        {experience.tasks && (
                          <div className="bg-purple-50 p-8 rounded-2xl border border-purple-100">
                             <h3 className="text-xl font-bold text-purple-900 mb-4 flex items-center gap-2">
                               <Rocket size={20} /> Missions principales
                             </h3>
                             <ul className="space-y-3">
                                {experience.tasks.map((task, i) => (
                                   <li key={i} className="flex items-start gap-3 text-purple-800">
                                      <span className="mt-1.5 w-1.5 h-1.5 bg-purple-600 rounded-full flex-shrink-0"></span>
                                      <span>{task}</span>
                                   </li>
                                ))}
                             </ul>
                          </div>
                        )}
                     </div>

                     <div className="space-y-6">
                         <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100">
                            <div className="h-48 bg-gray-100 flex items-center justify-center text-gray-400">
                               <AutoMedia
                                    src={`images/${experience.id}.jpg`}
                                    alt={experience.company}
                                    className="w-full h-full object-cover"
                                    interactive={false}
                                    fallback={(
                                      <div className="flex flex-col items-center text-gray-400">
                                        <Briefcase size={40} />
                                        <span className="text-xs mt-2">Media non disponible</span>
                                      </div>
                                    )}
                                />
                            </div>
                         </div>
                     </div>
                  </div>
               </div>
            );
          };

          // NOUVELLE PAGE : D√âTAIL D'UN PROJET
          const PageProjetDetail = ({ projectId, onBack, onOpenSkill, onOpenCoreCompetency }) => {
            const proj = projects.find(p => p.id === projectId);

            if (!proj) return null;

            const c = proj.content || {};
            // Sections 100% modifiables depuis l'admin (compat avec anciens champs block1/2/3)
            const contexteTitle = c.contexteTitle || "Contexte";
            const contexteText  = c.contexteText  || c.block1Text || "Ajoute ici un texte d√©taill√© : contexte, contraintes, cahier des charges‚Ä¶";
            const objectifTitle = c.objectifTitle || "Objectif";
            const objectifText  = c.objectifText  || "Ajoute ici l'objectif, les besoins, les crit√®res de r√©ussite‚Ä¶";

            const realisationTitle = c.realisationTitle || c.block2Title || "R√©alisation & choix techniques";
            const realisationText  = c.realisationText  || c.block2Text  || "Ajoute ici : architecture, techno utilis√©es, sch√©mas, logique, automatisme, IHM, etc.";

            const resultatsTitle = c.resultatsTitle || "R√©sultats";
            const resultatsText  = c.resultatsText  || c.block3Text || "Ajoute ici : r√©sultats, tests, mesures, points forts‚Ä¶";
            const bilanTitle = c.bilanTitle || "Bilan";
            const bilanText  = c.bilanText  || "Ajoute ici : limites, am√©liorations futures, apprentissages.";

            const pdfPath = `projects/${proj.id}.pdf`;

            const captions = proj.mediaCaptions || {};
            const cap1 = (captions['1'] || '').trim();
            const cap2 = (captions['2'] || '').trim();
            const cap3 = (captions['3'] || '').trim();

            return (
              <div className="space-y-8 animate-fadeIn pt-12">
                <div className="bg-white/95 backdrop-blur-md p-6 rounded-2xl shadow-lg border-l-8 border-blue-600 mb-8 relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                  <div>
                    <div className="flex items-center gap-3 mb-1">
                      <span className="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">{proj.year}</span>
                      <h2 className="text-3xl font-bold text-gray-900">{proj.title}</h2>
                    </div>
                    
                    <div className="flex gap-2 mt-2 flex-wrap">
                      {proj.competencies && proj.competencies.map((compName, i) => {
                        const coreComp = coreCompetencies.find(c => c.title === compName);
                        return (
                          <button 
                            key={`core-${i}`}
                            onClick={() => onOpenCoreCompetency(compName)}
                            className={`text-xs font-bold px-2 py-1 rounded border transition-colors ${coreComp ? coreComp.tagStyle : 'bg-gray-100'}`}
                          >
                            {compName}
                          </button>
                        );
                      })}
                      {proj.tags.map((tag, i) => (
                        <button
                          key={i}
                          onClick={() => onOpenSkill(tag)}
                          className="text-xs font-semibold text-gray-600 bg-gray-100 px-2 py-1 rounded hover:bg-gray-200 transition-colors"
                        >
                          {tag}
                        </button>
                      ))}
                    </div>
                  </div>

                  <button
                    onClick={onBack}
                    className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-white font-semibold hover:bg-gray-700 whitespace-nowrap"
                  >
                    ‚Üê Retour aux projets
                  </button>
                </div>

                {/* IMAGE 1 (hero) */}
                <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100">
                  <div className="relative">
                    <AutoMedia
                      src={`images/${proj.id}-1.jpg`}
                      alt={proj.title}
                      className="w-full h-[300px] md:h-[420px] object-cover hover:opacity-95 transition-opacity"
                      interactive={true}
                      onOpen={(finalSrc) => setFullscreenImage(finalSrc)}
                      fallback={(
                        <div className="w-full h-[300px] md:h-[420px] flex items-center justify-center bg-gray-100 text-gray-500 text-sm">
                          Media <span className="font-mono ml-1">{proj.id}-1.(jpg/mp4)</span> manquant
                        </div>
                      )}
                    />
                    <div className="absolute inset-0 bg-gradient-to-t from-black/35 to-transparent pointer-events-none"></div>
                    {cap1 && (
                      <div className="absolute bottom-0 left-0 right-0 px-5 py-3 text-white font-extrabold text-sm md:text-base bg-black/40 backdrop-blur-sm pointer-events-none">
                        {cap1}
                      </div>
                    )}
                  </div>
                  
                  <div className="p-6 md:p-8">
                    <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                      {proj.desc}
                    </p>
                  </div>
                </div>

                {/* BLOCS TEXTE + IMAGES √Ä C√îT√â */}
                <div className="space-y-6">
                  {/* Bloc 1 + Image 2 */}
                  <div className="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                    <div className="grid md:grid-cols-12 gap-0">
                      <div className="p-6 md:p-10 md:col-span-7">
                        <h3 className="text-2xl font-extrabold text-gray-900 mb-3">{contexteTitle}</h3>
                        <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                          {contexteText}
                        </p>

                        <div className="mt-6">
                          <h4 className="text-xl font-extrabold text-gray-900 mb-2">{objectifTitle}</h4>
                          <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                            {objectifText}
                          </p>
                        </div>
                      </div>

                      <div className="md:col-span-5 bg-gray-50">
                        <div className="relative h-[280px] md:h-[420px]">
                          <AutoMedia
                            src={`images/${proj.id}-2.jpg`}
                            alt={`${proj.title} - media 2`}
	                            className="absolute inset-0 w-full h-full object-contain hover:opacity-95 transition-opacity"
                            interactive={true}
                            onOpen={(finalSrc) => setFullscreenImage(finalSrc)}
                            fallback={(
                              <div className="absolute inset-0 flex items-center justify-center text-gray-400 text-sm">
                                Media <span className="font-mono ml-1">{proj.id}-2.(jpg/mp4)</span> manquant
                              </div>
                            )}
                          />
                          {cap2 && (
                            <div className="absolute bottom-0 left-0 right-0 px-4 py-2 text-white font-extrabold text-xs md:text-sm bg-black/40 backdrop-blur-sm pointer-events-none">
                              {cap2}
                            </div>
                          )}

                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Bloc 2 + Image 3 */}
                  <div className="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                    <div className="grid md:grid-cols-12 gap-0">
                      <div className="md:col-span-5 bg-gray-50 order-2 md:order-1">
                        <div className="relative h-[280px] md:h-[420px]">
                          <AutoMedia
                            src={`images/${proj.id}-3.jpg`}
                            alt={`${proj.title} - media 3`}
	                            className="absolute inset-0 w-full h-full object-contain hover:opacity-95 transition-opacity"
                            interactive={true}
                            onOpen={(finalSrc) => setFullscreenImage(finalSrc)}
                            fallback={(
                              <div className="absolute inset-0 flex items-center justify-center text-gray-400 text-sm">
                                Media <span className="font-mono ml-1">{proj.id}-3.(jpg/mp4)</span> manquant
                              </div>
                            )}
                          />
                          {cap3 && (
                            <div className="absolute bottom-0 left-0 right-0 px-4 py-2 text-white font-extrabold text-xs md:text-sm bg-black/40 backdrop-blur-sm pointer-events-none">
                              {cap3}
                            </div>
                          )}

                        </div>
                      </div>

                      <div className="p-6 md:p-10 md:col-span-7 order-1 md:order-2">
                        <h3 className="text-2xl font-extrabold text-gray-900 mb-4">{realisationTitle}</h3>
                        <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                          {realisationText}
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* R√©sultats + Bilan (2 colonnes) */}
                  <div className="grid md:grid-cols-2 gap-6">
                    <div className="bg-white p-6 md:p-10 rounded-2xl shadow-lg border border-gray-100">
                      <h3 className="text-2xl font-extrabold text-gray-900 mb-4">{resultatsTitle}</h3>
                      <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                        {resultatsText}
                      </p>
                    </div>
                    <div className="bg-white p-6 md:p-10 rounded-2xl shadow-lg border border-gray-100">
                      <h3 className="text-2xl font-extrabold text-gray-900 mb-4">{bilanTitle}</h3>
                      <p className="text-gray-700 leading-relaxed text-base md:text-lg whitespace-pre-line">
                        {bilanText}
                      </p>
                    </div>
                  </div>
                </div>

                {/* PDF VIEWER - extrait en mode paysage (plus grand) */}
                <div className="bg-slate-900 rounded-2xl shadow-xl overflow-hidden border border-slate-800">
                  <div className="p-5 md:p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                    <div>
                      <h3 className="text-white font-extrabold text-lg flex items-center gap-2">
                        <Download size={18} /> Extrait du rapport (PDF)
                      </h3>
                      <p className="text-slate-300 text-sm">
                        Lecture directe sur le site ‚Äî fichier attendu : <span className="font-mono">{proj.id}.pdf</span>
                      </p>
                    </div>

                    <div className="flex gap-2">
                      <button
                        onClick={() => setFullscreenImage(pdfPath)}
                        className="px-4 py-2 rounded-xl bg-white/10 text-white font-semibold hover:bg-white/20 transition-colors"
                      >
                        Plein √©cran
                      </button>
                      <a 
                        href={pdfPath}
                        target="_blank" 
                        className="px-4 py-2 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-500 transition-colors"
                      >
                        Ouvrir / T√©l√©charger
                      </a>
                    </div>
                  </div>

                  <div className="w-full bg-white h-[65vh] md:h-[75vh]">
                    <iframe 
                      src={`${pdfPath}#page=1&view=FitH&zoom=page-width&toolbar=0&navpanes=0`} 
                      title={`PDF ${proj.title}`}
                      className="w-full h-full border-0"
                    />
                  </div>
                </div>
              </div>
            );
          };


          return (
            <div className="min-h-screen bg-white font-sans text-gray-800 flex flex-col">
              
              {/* --- LIGHTBOX (MODAL IMAGE PLEIN √âCRAN) --- */}
              {fullscreenImage && (
                <div 
                    className="fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fadeIn"
                    onClick={() => setFullscreenImage(null)}
                >
                    {/* Bouton fermer */}
                    <button 
                        className="absolute top-4 right-4 text-white/70 hover:text-white bg-black/50 hover:bg-black/80 rounded-full p-2 transition-all z-50"
                        onClick={() => setFullscreenImage(null)}
                    >
                        <X size={32} />
                    </button>

                    {/* Contenu : Image ou PDF */}
                    {fullscreenImage.endsWith('.pdf') ? (
                        <iframe 
                            src={fullscreenImage} 
                            className="w-full max-w-4xl h-[85vh] bg-white rounded-lg shadow-2xl"
                            onClick={(e) => e.stopPropagation()} 
                        ></iframe>
                    ) : fullscreenImage.endsWith('.mp4') ? (
                        <video
                            src={fullscreenImage}
                            muted
                            playsInline
                            autoPlay
                            loop
                            className="max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl bg-black"
                            onClick={(e) => { e.stopPropagation(); e.preventDefault(); }}
                            onPause={(e) => { try { e.currentTarget.play(); } catch {} }}
                            disablePictureInPicture
                            controlsList="nodownload noremoteplayback noplaybackrate"
                        />
                    ) : (
                        <img 
                            src={fullscreenImage} 
                            alt="Zoom projet" 
                            className="max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"
                            onClick={(e) => e.stopPropagation()} 
                        />
                    )}
                </div>
              )}

              {/* --- NAVIGATION BAR FIXED --- */}
              <nav className="fixed top-0 left-0 w-full z-50 bg-blue-900 shadow-xl border-b border-blue-800">
                <div className="max-w-7xl mx-auto px-4">
                  <div className="flex flex-col md:flex-row justify-between items-center md:h-16 py-1 md:py-0">
                    {/* Logo */}
                    <div 
                      className="font-bold text-xl tracking-wider text-white cursor-pointer hover:text-blue-200 transition py-2 md:py-0"
                      onClick={() => { setActiveTab('accueil'); setActiveProject(null); setActiveSkill(null); setActiveCoreCompetency(null); setActiveCoreCompetencyLevel(null); setActiveInterest(null); setActiveExperience(null); }}
                    >
                      ETHAN ALLOUCHE
                    </div>
                    
                    {/* Tabs Menu - Always Visible */}
                    <div className="flex gap-1 overflow-x-auto w-full md:w-auto justify-center md:justify-end no-scrollbar">
                      {navItems.map((item) => (
                        <button 
                          key={item.id}
                          onClick={() => { setActiveTab(item.id); setActiveProject(null); setActiveSkill(null); setActiveCoreCompetency(null); setActiveCoreCompetencyLevel(null); setActiveInterest(null); setActiveExperience(null); setActiveFormation(null); }}
                          className={`
                            px-3 py-2 text-xs md:text-sm font-bold uppercase tracking-wide rounded-t-lg transition-all flex items-center gap-2 mt-2 md:mt-4 whitespace-nowrap
                            ${activeTab === item.id 
                              ? 'bg-white text-blue-900 translate-y-1 shadow-[0_-2px_10px_rgba(0,0,0,0.1)]' 
                              : 'text-blue-200 hover:text-white hover:bg-blue-800'
                            }
                          `}
                        >
                          {item.icon} {item.label}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
              </nav>

              {/* --- MAIN CONTAINER --- */}
              <div className="flex-grow pt-24 md:pt-16 overflow-x-hidden w-full">
                <div className="w-full bg-white relative overflow-hidden min-h-screen">
                  
                  {/* --- FOND GRAPHIQUE FIXE (IDENTIT√â VISUELLE) --- */}
                  <div className="absolute top-0 left-0 w-[60%] h-64 bg-blue-900 transform -skew-x-12 -translate-x-16 -translate-y-10 z-0"></div>
                  <div className="absolute top-0 left-0 w-[65%] h-64 bg-blue-600/80 transform -skew-x-12 -translate-x-10 -translate-y-8 z-0"></div>
                  
                  <div className="absolute bottom-0 right-0 w-[40%] h-64 bg-blue-900 transform -skew-x-12 translate-x-16 translate-y-20 z-0 opacity-20 md:opacity-100"></div>
                  <div className="absolute bottom-0 right-0 w-[45%] h-64 bg-blue-500 transform -skew-x-12 translate-x-10 translate-y-16 z-0 opacity-20 md:opacity-100"></div>
                  
                  {/* --- ZONE DE CONTENU DYNAMIQUE --- */}
                  <div className="relative z-10 p-6 md:p-12 min-h-[600px] max-w-7xl mx-auto">
                    {activeTab === 'accueil' && <PageAccueil />}
                    {activeTab === 'competences' && (
                      activeCoreCompetencyLevel
                        ? <PageCoreCompetencyLevelDetail
                            competencyTitle={activeCoreCompetencyLevel.competencyTitle}
                            levelId={activeCoreCompetencyLevel.levelId}
                            onBack={() => setActiveCoreCompetencyLevel(null)}
                            onBackToCompetency={() => { setActiveCoreCompetencyLevel(null); setActiveCoreCompetency(activeCoreCompetencyLevel.competencyTitle); }}
                            onOpenProject={(projectId) => {
                              setActiveCoreCompetencyLevel(null);
                              setActiveCoreCompetency(null);
                              setActiveTab('projets');
                              setActiveProject(projectId);
                            }}
                          />
                        : activeCoreCompetency
                          ? <PageCoreCompetencyDetail 
                              competencyTitle={activeCoreCompetency}
                              onBack={() => { setActiveCoreCompetency(null); setActiveCoreCompetencyLevel(null); }}
                              onOpenLevel={(levelId) => setActiveCoreCompetencyLevel({ competencyTitle: activeCoreCompetency, levelId })}
                            />
                          : activeSkill 
                              ? <PageSkillDetail 
                                  skillName={activeSkill} 
                                  onBack={() => setActiveSkill(null)} 
                                  onOpenProject={(projectId) => {
                                    setActiveSkill(null);
                                    setActiveTab('projets');
                                    setActiveProject(projectId);
                                  }}
                                />
                              : <PageCompetences 
                                  onOpenSkill={setActiveSkill} 
                                  onOpenCoreCompetency={(compName) => { setActiveCoreCompetency(compName); setActiveCoreCompetencyLevel(null); }}
                                />
                    )}
                    
                    {/* ROUTING POUR L'ONGLET FORMATION (ANCIENNEMENT ETUDES) */}
                    {activeTab === 'etudes' && (
                        activeFormation 
                        ? <PageDetailFormation onBack={() => setActiveFormation(true)} />
                        : <PageEtudes onOpenFormation={() => setActiveFormation(true)} />
                    )}

                    {activeTab === 'projets' && (
                      activeProject
                        ? <PageProjetDetail 
                            projectId={activeProject} 
                            onBack={() => setActiveProject(null)}
                            onOpenSkill={(skillName) => {
                              setActiveProject(null);
                              setActiveTab('competences');
                              setActiveSkill(skillName);
                            }}
                            onOpenCoreCompetency={(compName) => {
                                setActiveProject(null);
                                setActiveTab('competences');
                                setActiveCoreCompetency(compName);
                                setActiveCoreCompetencyLevel(null);
                            }}
                          />
                        : <PageProjets 
                            onOpenProject={setActiveProject} 
                            onOpenSkill={(skillName) => {
                              setActiveTab('competences');
                              setActiveSkill(skillName);
                            }} 
                            onOpenCoreCompetency={(compName) => {
                                setActiveTab('competences');
                                setActiveCoreCompetency(compName);
                                setActiveCoreCompetencyLevel(null);
                            }}
                          />
                    )}
                    {activeTab === 'experience' && (
                        activeExperience
                        ? <PageExperienceDetail 
                            experience={activeExperience}
                            onBack={() => setActiveExperience(null)}
                          />
                        : <PageExperience 
                            onOpenExperience={setActiveExperience}
                            onOpenProject={(projectId) => {
                              setActiveExperience(null);
                              setActiveTab('projets');
                              setActiveProject(projectId);
                            }}
                          />
                    )}
                    {activeTab === 'interets' && (
                        activeInterest
                        ? <PageInteretDetail 
                            interestId={activeInterest}
                            onBack={() => setActiveInterest(null)}
                          />
                        : <PageInterets onOpenInterest={setActiveInterest} />
                    )}
                    {activeTab === 'admin' && isAdmin && (
                      <PageAdminFiles 
                        onExit={() => {
                          setIsAdmin(false);
                          setActiveTab('accueil');
                          try {
                            window.history.replaceState(null, '', window.location.pathname + window.location.search);
                          } catch (e) {
                            window.location.hash = '';
                          }
                        }} 
                      />
                    )}
                  </div>
                  
                  {/* --- MASCOTTE ROBOT AJOUT√âE ICI --- */}
                  {/* On passe activeTab au robot pour qu'il sache o√π se placer */}
                  <Mascot activeTab={activeTab} />
                  
                </div>
              </div>
            </div>
          );
        };

	    async function bootstrap() {
	// 1) Si data/content.js est pr√©sent (recommand√©), il a d√©j√† d√©fini window.__PORTFOLIO_CONTENT__.
	// 2) Sinon, on tente de charger data/content.json (OK sur GitHub Pages / localhost, parfois bloqu√© sur file://)
	if (!window.__PORTFOLIO_CONTENT__) {
	  try {
	      const res = await fetch('./data/content.json', { cache: 'no-store' });
	      if (res.ok) {
	          window.__PORTFOLIO_CONTENT__ = await res.json();
	      }
	  } catch (e) {
	      // Fallback : on garde les donn√©es par d√©faut
	  }
	}

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(
        <Portfolio />
    );
}

bootstrap();
    </script>
</body>
</html>
